<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Xiaoyan Chen" />

<meta name="date" content="2021-12-21" />

<title>Answers for StatComp Homework</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Answers for StatComp Homework</h1>
<h4 class="author">Xiaoyan Chen</h4>
<h4 class="date">2021-12-21</h4>



<p>#HW1</p>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples(texts,figures,tables)</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>Example 1: Use the dataset “women” in R to build a simple linear model of weight and height.<br />
First,we can know the basic information of “women”,there are two variables,weight and height</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">summary</span>(women))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">height</th>
<th align="left">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"></td>
<td align="left">Min. :58.0</td>
<td align="left">Min. :115.0</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">1st Qu.:61.5</td>
<td align="left">1st Qu.:124.5</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Median :65.0</td>
<td align="left">Median :135.0</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Mean :65.0</td>
<td align="left">Mean :136.7</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">3rd Qu.:68.5</td>
<td align="left">3rd Qu.:148.0</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Max. :72.0</td>
<td align="left">Max. :164.0</td>
</tr>
</tbody>
</table>
<p>And then draw scatterplot of weight and height<br />
</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(women<span class="sc">$</span>height,women<span class="sc">$</span>weight,<span class="at">xlab =</span> <span class="st">&quot;Height(in inches)&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;Weight(in lbs)&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>we can see a linear trend between weight and height from the scatterplot,namely,when height increases, so does weight gain.Thus,we can build a simple linear model of them<br />
</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(women<span class="sc">$</span>height,women<span class="sc">$</span>weight,<span class="at">xlab =</span> <span class="st">&quot;Height(in inches)&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;Weight(in lbs)&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>mymodel <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight<span class="sc">~</span>height,<span class="at">data=</span>women)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mymodel)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">summary</span>(mymodel)<span class="sc">$</span>coef)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-87.51667</td>
<td align="right">5.9369440</td>
<td align="right">-14.74103</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">height</td>
<td align="right">3.45000</td>
<td align="right">0.0911365</td>
<td align="right">37.85531</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>The <span class="math inline">\(R^2\)</span> is 0.9910098<br />
From the output,we can get the formula:<br />
<span class="math display">\[\hat{Weight}=-87.52+3.45\times Height\]</span> The p-value of coefficient means the coefficient is significantly not 0(p&lt;0.001),indicating that for every inch gain in height, the weight will increase by an average of 3.45 pounds.The R-squared term indicates that the model can explain the 99.1% of variance of the weight,which is also the square of the correlation coefficient between the actual and predict values.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.new()</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># par(mfrow=c(2,2))</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(mymodel)</span></span></code></pre></div>
<p>From the plot of residuals and fitted value, a secondary function relationship between them can be seen,meanwhile,there is a slight deviation at the tail of Q-Q plot,which means the simple linear model can be further improved.<br />
The lower-left plot shows a basic determination of variance,which satisfies the assumption that the variance is constant in the linear model.<br />
</p>
<p>Example 2:Continue with example 1 and add a secondary square to improve the model<br />
From the scatterplot of weight and height and the residuals plot,we can try to add a secondary square in simple linear model to improve prediction accuracy.<br />
</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>mymodel2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight<span class="sc">~</span>height<span class="sc">+</span><span class="fu">I</span>(height<span class="sc">^</span><span class="dv">2</span>),<span class="at">data=</span>women)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(women<span class="sc">$</span>height,women<span class="sc">$</span>weight,<span class="at">xlab =</span> <span class="st">&quot;Height(in inches)&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;Weight(in lbs)&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>mymodel <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight<span class="sc">~</span>height,<span class="at">data=</span>women)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(women<span class="sc">$</span>height,<span class="fu">fitted</span>(mymodel2))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">summary</span>(mymodel2)<span class="sc">$</span>coef)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">261.878184</td>
<td align="right">25.1967708</td>
<td align="right">10.393323</td>
<td align="right">2e-07</td>
</tr>
<tr class="even">
<td align="left">height</td>
<td align="right">-7.348319</td>
<td align="right">0.7776923</td>
<td align="right">-9.448878</td>
<td align="right">7e-07</td>
</tr>
<tr class="odd">
<td align="left">I(height^2)</td>
<td align="right">0.083064</td>
<td align="right">0.0059796</td>
<td align="right">13.891131</td>
<td align="right">0e+00</td>
</tr>
</tbody>
</table>
<p>The <span class="math inline">\(R^2\)</span> is 0.9994737<br />
From the output,we can get the new formula is:<br />
<span class="math display">\[\hat{Weight}=261.88-7.35\times Height+0.083\times Height^2\]</span> From the new fitted curve,a better fit can be seen,verifying the correction of the improvement.At levels where p-value is less than 0.001,the regression coefficient is very significant.The model variance interpretation rate has increased to 99.9%.The secondary significance indicates that the inclusion of the secondary item improves the fit of the model.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.new()</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># par(mfrow=c(2,2))</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(mymodel2)</span></span></code></pre></div>
<p>The residual plot shows that the residuals are roughly distributed around 0 and the Q-Q plot shows that the fitted quantile approximate the quantile of standard and normal distribution.The above diagrams show that the polynomial regression fitting effect is ideal,which basically conforms to the linear hypothesis,residual normality and homoscedasticity.</p>
<p>Example 3:Use the dataset “Nile” in R to build a ARIMA model<br />
</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(forecast)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(tseries)</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(Nile)</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ndiffs(Nile)</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># dnile &lt;- diff(Nile)</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(dnile)</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># adf.test(dnile)</span></span></code></pre></div>
<p>We can see there is a descend trend in the series from the time series plot.The series in differenced once and certainly looks more stationary.Applying the ADF test to the differenced serires suggest that it’s now stationary.<br />
Possible models are selected based on the ACF and PACF plots：</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Acf(dnile)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pacf(dnile)</span></span></code></pre></div>
<p>Except one point, the value of ACF is near 0 after lag 1 from the ACF plot.This suggest tring an arima(0,1,1)model.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mymodel3 &lt;-  arima(Nile,order=c(0,1,1))</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mymodel3</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># knitr::kable(accuracy(mymodel3))</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># qqnorm(mymodel3$residuals)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># qqline(mymodel3$residuals)</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Box.test(mymodel3$residuals,type=&quot;Ljung-Box&quot;)</span></span></code></pre></div>
<p>If the model is approximate, the residuals should be normality distributed with mean zero,and the autocorrelations should be zero for every possible lag.From the diagram,the results look good.The results of the test aren’t significant,suggesting that the autocorrelations don’t differ from zero.</p>
<p>#HW2 ## Question 1 Exercise 3.4:The Rayleigh density is<br />
<span class="math display">\[ f(x)=\frac{x}{\sigma^2}e^{-\frac{x^2}{2\sigma^2}},\qquad   x\geq0,\sigma&gt;0.\]</span> Develop an algorithm to generate random samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution.Generate Rayleigh(<span class="math inline">\(\sigma\)</span>) samples for several choices of <span class="math inline">\(\sigma\)</span>&gt;0 and check that the mode of the generated samples is close to the theoretical mode <span class="math inline">\(\sigma\)</span>(check the histogram).<br />
</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>1)develop the algorithm to generate random samples<br />
we can get the cdf <span class="math display">\[F(x)=1-e^{-\frac{x^2}{2\sigma^2}},\qquad   x\geq0,\sigma&gt;0\]</span></p>
<p>Use the inverse transform algorithm:<br />
1.generate V~U(0,1)<br />
2.return Y=<span class="math inline">\(F_Y^{-1}(V)\)</span></p>
<p>2)generate samples for several choice and check the mode</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>,<span class="dv">5</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.new()</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># par(mfrow=c(3,2))</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sigma)){</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">2</span>)<span class="sc">*</span>sigma[i]<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>v))</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>za <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fu">range</span>(y)[<span class="dv">2</span>],<span class="fl">0.01</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y,<span class="at">prob=</span><span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(y) <span class="sc">==</span> <span class="fu">frac</span>(y,sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span><span class="fu">frac</span>(y<span class="sc">^</span><span class="dv">2</span>,sigma<span class="sc">^</span><span class="dv">2</span>))))</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(za,(za<span class="sc">/</span>(sigma[i]<span class="sc">^</span><span class="dv">2</span>))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(za<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(sigma[i]<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAw1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmOmZmOpBmZmZmZpBmkLZmkNtmtrZmtttmtv+QOgCQOjqQOmaQZgCQZjqQZmaQkJCQkLaQtv+Q27aQ2/+cZgC2ZgC2Zjq2Zma2kGa2kJC2kLa22/+2/7a2///T09PbkDrbtmbb25Db////tmb/tpD/25D/27b//7b//9v///9vxPR+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKwUlEQVR4nO2de4PbRhXFj0M3LqUP1qGUFmhNKQQWhbZpV22EY/n7fyokjSTrPXfsK92r0fz+cJxd5czVybxnNMIlMAmkA9AOpAPQDqQD0A6kA9AOpAPQDqQD0A6kA9AOpAPQDqQD0A6kA9AOpAPQDqQD0A6kA9AOpAPQDqQD0A6kA2AlPQIP71glwaomTfLycom+YZUEq5oG4mDQJHkm4gS8cuJEzP54ZlB65C1fl1UYlOAx+zwfCHkjQsYja+pgVZsFY02C6cyRNV6nz2ZIHTNochO9+Ln8mCBzh7n9MmAGTW7yzDNSwtIfq25h+u1PfygtTP/J2FcEn9Rs5OYMl7Dz6+v3+Mu68kn/MZ3bXACb0ozEL34eLGHpt40fnl89Xb//iS0PgUtoTk77vw6WsFan8PRJwxS+8Qa4hOYkPf5mP3DHrV5PvHtq/CphG7KCSWdeYgyVsGah6nD6LVctBCadeTnth0rY6cOGQWjQ+dVdgEnHmfSHf9Xf//dnS4EYbsOS3XgOGiqSNwEmHVfef/G28bfTF5Ml4v1xsEopskk+R5bxcuBXLIBJh8r5c+S54fzH9g1M1Rnnw8j4ql8H1TOK662DsuFkVjDSY/eO4/FmJ7vr4UFWf+xezyiuthVLj0VzFPdqj9P+hkH44ORYMSJ7s9Z+UFrUJudD7z+4dM6R//b/TWHaanvSialPE1OntiZ6Ist0xpX332XF1LR756+6RpgZxR/WOhYrDYpMpdua6Im7DdEYp32j2bqO5s1fi1qp88P7AJ8UhaKIZbWuyS3NiZ6EuqAV4feZxJtuhsubx4f/rH5GsTAoa7fN3TUnepJyNBFV3eHix+hjOtXpsZPh4q/T15cZwByi47QNak70JIPDrT5lCeutoL558mJGsW1Qc6LH2aDO5fEj95qqATNoTtCug5oTPVUd1C5ifcY6TOl3+JR3Vd6AGTQnMP2gqKpIGxM91FYsPe7+kkn8Mji+nwEsk0yFMSipzbhO9MTUflBZxsZH8rxgmWQquj3peqKH0JPOnclNzDuK+PSt5WousFA6beqxWHKtjWzdl/Phm6kZoLnA0gkWVL2Y60TPxGi+JCmq9zkaqkmwdIKGYj6oMdFz+pjUxue5aGGwdIIl6d+eGhM97fnFcez5jB0snWBF+n1jTvo17b7jW6ZE7gSLp3g7/Wm2BcDySd6KRP5ZgUG/fFSOTX9lW6hwAhKJOpBUQzMz10OedmQDSyfoxvmw+zpzybawOCMQS5lE2cGOX4o5BKmEaZRDEb6VZGcglTCN0pnzgXei2QFIJUwkMivJtywr8gCphImcDw9vL+8//0CiC1QAqYSppG+A3WehFVMLpAPQDqQD0A6kA9AOpAPQDqQD0A6kA9AOpAPQDqQD0A6kA9AOpAPQDqQD0A6kA9AOpAPQDqQD0A6kA9AOpAPQDqQD0A5mEW09HrluMIvoc80s+ksCHpV2hgkGWeSCQRa5YJBFLhhkkQsGWeSCQRa5YJBFLhhkkQsGWeS2a1AEvCxOExnbEWfkNmtQ/qhElD8MN7olzsht1aDiSBLzyNbYUyVGbqsGFQ8jJcUDAcnIYwFGbqsGOecgbMygax3UP/+nJVcalFXmGzPIsRXD8+YMIsoFgyxyqGugzRo09nCbkasNeg6T9qXK0Jx0MGhULhhkkduuQeWxl+NH/Rg5VP74ZND5YD+fJq4OSkjGDgozcl4alN++5YC0Rv+ZMNSAj2OxaY8aJ2cQBqteGmQsGqthQg5KilFWOnw48aVxShS5DvLJoPywGuPMWPkx1wwc0deV89Kg84Hj6BAj56dB5enV49mHLue1QfedsWLkmgZh8nr9wPwRXYebdz2hbuQ8NGjyJRXOcqj98cggTrlgkEXOP4POh8eqi0M8lHdSzj+DmOWCQRY5Pw3KNyTE974q2cg1DVr7ww6ov0UP7/KzeW96k+vApL13BhWH7Wajda6hhpcG5efLcw01vDMoK1v5OdikF+La5Pw0KOsI7Z56r6u4Sc5PgxjlgkEWOT8Nsi4K0uVQ++OTQba3TTvItQxauUOovvAcdmnkPDWIfFzqxMmqRs5LgwgNfD0jMl5TGbmmQWt//hn1t+GXvbYo1wudclCjPVslqL6QJszMO2e2aRCRaPcUDJokxuNWDcoK2cO7yNrYn/aDL39vyvlpULJ7ivPRvNWh6wvmxuTaBq17ERrVl3zzT77rh2k+yD+D8o5ibhBtRtG6kdw/g6ocFN0ya9+fk/bPoLIOIr9qcErOT4NMV/HOXVRGzlODCJA3ktcPZW7LIPpGcg8NMmOxyRraYRtwy6DygyPc5UH5Z1S99X2in+iwkdw7g+oXmE69ZmjDOagxWza1Nk/fSO6bQY0R2ORQg7yR3D+DrLWLi1wwyCLXNcg09nfICoLiMxg0CorPYNAoKD4JCzoucv4ZxCw3bNA6l8gwh9ywQc81zInOCuaQCwZZ5HoGNRY3gkGXYNCASndOOhg0KRcMssjhakYwaEiub9AzgkENuWCQRS4YZJELBlnkrAataFSGOeQGDHpG06AV5SXMIbddg6hLz1s1iLz0PGDQ8wYMoi8cbtQg+tLzRg26MwcN/vD2yBcCLheTl57pBqnvEsHpaurS83AR686BdMrdPbcxH5hDbswgDPxwKDPxxnQfmENuuD6+lrI11dy47Z9RDtwe8AJA/4f9KzXlJfCodOakVSNhkMdAOgDtwOlqlmfr1wVcLrYPVv0DDtcShhqlqCy3ejF8Lw7XkrdZ0UVlr+RWo+egGZKf40p2Nftg1VVU9kp+Netg1VVU9srl1ZxFZa9cXs1ZVPbK5dWcRWWvXF7NWVT2yuXVnEVlr1xezUMgHYB2IB2AdiAdgHYgHYB2IB2AdiAdgHYgHYB2IB2AdiAdgHYgHYB2IB2AdiAdgHbArphQj7EqViHJ62vEs9VOe9hfqOsCOMVy8nNkEopD6TG7KqbeTUJ7ZUySXXXnix06gFErxywNUV7vYg7iIR7bWJwSSk39vqMgO4BPqsDpti8XWmbL1+H+TjHo9CHHa/ZagFnPhEg/34J2kn6mSqqDkhc/He58S2MXcIpdqhxBzBfUXRB5ySEZFOf7Tu59eUobMGrluBmU0Opo8gmh8c4t/xIAn1SBUxEj7qIpNGkGFelOncPmDPikClwq6ckj91rXGey3bf5jWKtq8EkV0Jv5i9uxsaQcZDboqC5i9I7iae/U2tB60nlt1dilwwAYtQwxcahRFhxqe0ccaiQuwxcK4BTzEUgHoB1IB6AdSAegHUgHoB1IB6AdSAegHUgHoB1IB6AdSAegHUgHoB1IB6AdSAegHUgHoB1IB6AdSAegHUgHoB1IB6AdSAegHUgHoB1IB6AdSAegHUgHoB1IB6AdSAegHUgHoB1IB6AdSAegHUgHoB1IB6AdSAdgodiKFbPunXcDckmTSIptq4x7Dl2BXNIk8k11M2wPpwO5pGlkZWz6uKuZgVzSNLIyFkkeuQfBtEmcX/37lWAJ029QevydZAnTbxB5u/lMQDJxEqJt2CoM+kSyhK3AoFj22FiIpm7ntBetovUbJA6kA9AOpAPQDqQD0A6kA9AOpAPQDqQD0A6kA9AOpAPQDqQD0A6kA9AOpAPQDqQD0A6kA9AOpAPQDqQD0A6kA9AOpAPQDqQD0A6kA9AOpAPQzv8Bld3S4+rbOrgAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>from the output, we can get the mode of the generated samples for different parameter is close to the theoretical mode.</p>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>Exercise 3.11 Generate a random sample of size 1000 from a normal location mixture. The components of the mixture have N(0,1) and N(3,1) distributions with mixing probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span> = 1 − <span class="math inline">\(p_1\)</span>. Graph the histogram of the sample with density superimposed, for <span class="math inline">\(p_1\)</span> = 0.75. Repeat with different values for <span class="math inline">\(p_1\)</span> and observe whether the empirical distribution of the mixture appears to be bimodal. Make a conjecture about the values of <span class="math inline">\(p_1\)</span> that produce bimodal mixtures.</p>
</div>
<div id="ansewer" class="section level2">
<h2>Ansewer</h2>
<p>1)generate a random sample of size 1000 from a normal location mixture</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>U1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>U2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m,<span class="at">mean=</span><span class="dv">3</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(v<span class="sc">&gt;</span><span class="fl">0.75</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> t<span class="sc">*</span>U1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>t)<span class="sc">*</span>U2</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(U,<span class="at">prob=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>2)repeat with different values for <span class="math inline">\(p_1\)</span> and observe whether the empirical distribution of the mixture appears to be bimodal.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># l=1e4</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.new()</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># par(mfrow=c(3,2))</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># f &lt;- c(0.25,0.35,0.45,0.55,0.65,0.85)</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># for(i in 1:length(f)){</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   U1 &lt;- rnorm(l,mean=0,sd=1)</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># U2 &lt;- rnorm(l,mean=3,sd=1)</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># w &lt;- runif(l)</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># p &lt;- as.integer(w&gt;f[i])</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># U &lt;- p*U1+(1-p)*U2</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co"># hist(U,prob=TRUE)</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span></code></pre></div>
<p>from the output,we can observe the emprical distribution of the mixture appears to be bimodal.</p>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>Exercise 3.20 A compound Poisson process is a stochastic process {X(t), t ≥ 0} that can be represented as the random sum <span class="math display">\[X(t) = \sum_{i=1}^{N(t)}Y_i, t ≥ 0\]</span>, where <span class="math inline">\(\{N(t),t ≥ 0\}\)</span> is a Poisson process and <span class="math inline">\(Y_1\)</span>, <span class="math inline">\(Y_2\)</span>,… are i.i.d and independent of <span class="math inline">\(\{N(t),t ≥ 0\}\)</span>. Write a program to simulate a compound Poisson(<span class="math inline">\(\lambda\)</span>)–Gamma process (Y has a Gamma distribution). Estimate the mean and the variance of X(10) for several choices of the parameters and compare with the theoretical values. Hint: Show that <span class="math inline">\(E[X(t)] = \lambda tE[Y_1]\)</span> and <span class="math inline">\(Var(X(t)) = \lambda tE[Y_1^2]\)</span>.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p>1)write a program to simulate a compound poisson-gamma process.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#set the value of lambda</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>to <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#set the value of t</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>an <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){ </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  tn <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">1000</span>,lambda) <span class="co">#interarrival times</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>sn <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(tn)<span class="co">#arrival times</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">which</span>(sn <span class="sc">&gt;</span> to))<span class="co">#arrivals+1 in [0,t]</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>an[i] <span class="ot">&lt;-</span> m<span class="dv">-1</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(an)</span></code></pre></div>
<pre><code>## [1] 3.937</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>yn <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="fu">mean</span>(an),<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># according to the arrivals,generate corresponding number of random samples from gamma distribution,Y_i</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>xn <span class="ot">&lt;-</span> <span class="fu">sum</span>(yn) <span class="co">#sum the Y_i,get the value of compound process </span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(xn)</span></code></pre></div>
<pre><code>## [1] 0.7432335</code></pre>
<p>2)Estimate the mean and the variance of X(10) for several choices of the parameters and compare with the theoretical values.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>that <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>alph <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>scal <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>xn <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>wn <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){ </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a> tn <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">100</span>,lambda)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>sn <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(tn)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">which</span>(sn <span class="sc">&gt;</span> that))</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>xn[i] <span class="ot">&lt;-</span> m<span class="dv">-1</span> <span class="co">#generate the value of N(t)</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="fu">mean</span>(xn),alph,scal)<span class="co">#generate y according to the mean of N(t)</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>wn[j] <span class="ot">&lt;-</span> <span class="fu">sum</span>(y)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>}}</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(wn),lambda<span class="sc">*</span>that<span class="sc">*</span>alph<span class="sc">*</span>scal)<span class="co">#E(X(t))=lambda*t*E(Y),E(Y)=alpha*scale</span></span></code></pre></div>
<pre><code>## [1]  9.870192 10.000000</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">var</span>(wn),lambda<span class="sc">*</span>that<span class="sc">*</span>alph<span class="sc">*</span>scal<span class="sc">^</span><span class="dv">2</span>)<span class="co">#Var(X(t))=lambda*t*Var(Y),Var(Y)=alpha*scale^2</span></span></code></pre></div>
<pre><code>## [1]  9.010374 10.000000</code></pre>
<pre><code>## [1] 19.65366 20.00000</code></pre>
<pre><code>## [1] 27.9166 20.0000</code></pre>
<pre><code>## [1] 28.55602 30.00000</code></pre>
<pre><code>## [1] 25.67266 30.00000</code></pre>
<p>I change the value of lambda and repeat the program,for simplicity,I hide the code and only put the outcome. From the output, we can get the conclusion that the mean and variance of X(10) in simulation is close to the theoretical values.</p>
<p>#HW3 ## Question 1 Exercise 5.4: Write a function to compute a Monte Carlo estimate of Beta(3,3) cdf,and use the function to estimate F(x) for x=0.1,0.2,…,0.9.Compare the estimates with the values returned by the pbeta function in R.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<p>the pdf of Beta(3,3) distribution is <span class="math display">\[ f(x;3,3)=30x^2(1-x)^2\]</span> and then the cdf of Beta(3,3) is <span class="math display">\[F(t)=\int_{0}^{t}f(x;3,3) dx=\int_{0}^{t} 30x^2(1-x)^2 dx\]</span> we can get the estimation of Beta(3,3)cdf by the steps as follows: 1.Generate random number from Uniform(0,1):X~U(0,t) 2.Let <span class="math inline">\(h(X)=30tX^2(1-X)^2,x\in(0,t)\)</span>,then F(t)=E(h(X)),use a frequency to approximate the expectation:<span class="math inline">\(\hat{F(t)}=\frac{1}{l}\sum_{i=1}^{l}{h(X_i)}\)</span></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>cumugama <span class="ot">&lt;-</span> <span class="cf">function</span>(t){</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  l <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(l,<span class="at">min=</span><span class="dv">0</span>,<span class="at">max=</span>t)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  gamahat <span class="ot">&lt;-</span> <span class="dv">30</span><span class="sc">*</span>t<span class="sc">*</span><span class="fu">mean</span>((x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>((<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(gamahat)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span>,<span class="fl">0.7</span>,<span class="fl">0.8</span>,<span class="fl">0.9</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>gamahat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">9</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>gama <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">9</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(u)){</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  gamahat[i]<span class="ot">=</span><span class="fu">cumugama</span>(u[i])</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  gama[i]<span class="ot">=</span><span class="fu">pbeta</span>(u[i],<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 0.008571427
## [1] 0.05785851
## [1] 0.1628117
## [1] 0.3185434
## [1] 0.4995748
## [1] 0.6799083
## [1] 0.8346096
## [1] 0.9446642
## [1] 0.9940909</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">abs</span>(gamahat<span class="sc">-</span>gama)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">cbind</span>(u,gamahat,gama,error)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">u</th>
<th align="right">gamahat</th>
<th align="right">gama</th>
<th align="right">error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.1</td>
<td align="right">0.0085714</td>
<td align="right">0.00856</td>
<td align="right">0.0000114</td>
</tr>
<tr class="even">
<td align="right">0.2</td>
<td align="right">0.0578585</td>
<td align="right">0.05792</td>
<td align="right">0.0000615</td>
</tr>
<tr class="odd">
<td align="right">0.3</td>
<td align="right">0.1628117</td>
<td align="right">0.16308</td>
<td align="right">0.0002683</td>
</tr>
<tr class="even">
<td align="right">0.4</td>
<td align="right">0.3185434</td>
<td align="right">0.31744</td>
<td align="right">0.0011034</td>
</tr>
<tr class="odd">
<td align="right">0.5</td>
<td align="right">0.4995748</td>
<td align="right">0.50000</td>
<td align="right">0.0004252</td>
</tr>
<tr class="even">
<td align="right">0.6</td>
<td align="right">0.6799083</td>
<td align="right">0.68256</td>
<td align="right">0.0026517</td>
</tr>
<tr class="odd">
<td align="right">0.7</td>
<td align="right">0.8346096</td>
<td align="right">0.83692</td>
<td align="right">0.0023104</td>
</tr>
<tr class="even">
<td align="right">0.8</td>
<td align="right">0.9446642</td>
<td align="right">0.94208</td>
<td align="right">0.0025842</td>
</tr>
<tr class="odd">
<td align="right">0.9</td>
<td align="right">0.9940909</td>
<td align="right">0.99144</td>
<td align="right">0.0026509</td>
</tr>
</tbody>
</table>
<p>I write a function named cumugama() to estimate the beta(3,3)cdf and use the function to estimate F(x) for x=0.1,0.2,…,0.9..Comparing the reslut with the values returned by the pbeta function in R,we can see the absolute value of their difference is small,almost less then <span class="math inline">\(10^{-3}\)</span>,so we can get the conclusion that the estimation is close to the real value.</p>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<p>Exercise 5.9:The Rayleigh density is <span class="math inline">\(f(x)=\frac{x}{\sigma^2}e^{-\frac{x^2}{2\sigma^2}},x\geq0,\sigma &gt;0\)</span></p>
<p>Implement a function to generate samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>),using antithetic variables.What is the percent reduction in variance of <span class="math inline">\(\frac{X+X&#39;}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1\)</span>,<span class="math inline">\(X_2\)</span> ?</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>mcrandom <span class="ot">&lt;-</span> <span class="cf">function</span>(m,s,<span class="at">antithetic=</span><span class="cn">TRUE</span>){</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  w <span class="ot">&lt;-</span> <span class="fu">runif</span>(m<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>antithetic) wq <span class="ot">&lt;-</span> <span class="fu">runif</span>(m<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>  wq <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>w </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  xq <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(w))<span class="sc">*</span>s</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  xq <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(wq))<span class="sc">*</span>s</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">xq=</span>xq))</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>l<span class="ot">=</span><span class="fl">1e4</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>simu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>reduction <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(simu))</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(simu)){</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>mca <span class="ot">&lt;-</span> <span class="fu">mcrandom</span>(l,simu[i])</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>mcb <span class="ot">&lt;-</span> <span class="fu">mcrandom</span>(l,simu[i],<span class="at">antithetic =</span> <span class="cn">FALSE</span>)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">var</span>(mca<span class="sc">$</span>x<span class="sc">+</span>mca<span class="sc">$</span>xq)</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> <span class="fu">var</span>(mcb<span class="sc">$</span>x<span class="sc">+</span>mcb<span class="sc">$</span>xq)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>reduction[i] <span class="ot">&lt;-</span> (v2<span class="sc">-</span>v1)<span class="sc">/</span>v2</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(reduction)</span></code></pre></div>
<pre><code>## [1] 0.9467926 0.9475185 0.9466185 0.9464367 0.9415269</code></pre>
<p>The function in the code named “mcrandom” can generate samples from a Raleigh(<span class="math inline">\(\sigma\)</span>) using antithetic variable,the parameter “m” means the number of random numbers you want to generate,the parameter “s” represents the <span class="math inline">\(\sigma\)</span> of Raleigh(<span class="math inline">\(\sigma\)</span>) distribution.<br />
I try <span class="math inline">\(\sigma\)</span>=1,2,3,4,5 to generate random numbers of Raleigh(<span class="math inline">\(\sigma\)</span>) distribution with or without using antithetic variables and compute the percent reduction in variance of <span class="math inline">\(\frac{X+X&#39;}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>.From the output of the percent reduction of variance, we can see the values are greater than 94%.</p>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
<p>Exercise 5.13:Find two importance functions <span class="math inline">\(f_1\)</span>,<span class="math inline">\(f_2\)</span> that are supported on (1,<span class="math inline">\(\infty\)</span>) and are ‘close’ to <span class="math display">\[ g(x)=\frac{x^2}{\sqrt{2 \pi}}e^{-{x^2}/2} ,x&gt;1\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math inline">\(\int_{1}^{\infty} \frac{x^2}{\sqrt{2 \pi}}e^{-{x^2}/2} dx\)</span> by importance sampling?Explain.</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p>Let:<br />
<span class="math inline">\(f_1(x)=\frac{1}{\sqrt{2 \pi} }e^{-{x^2}/2}\)</span><br />
<span class="math inline">\(f_2(x)=\frac{1}{\Gamma(3)}x^2 e^{-x}\)</span><br />
</p>
<p><span class="math inline">\(g_1(x)=x^2\)</span><br />
<span class="math inline">\(g_2(x)=\Gamma(3)e^{-x^2+x}\)</span><br />
we can get <span class="math inline">\(g(x)=f_1(x)*g_1(x)=f_2(x)*g_2(x)\)</span> and <span class="math inline">\(f_1(x)\)</span> and <span class="math inline">\(f_2(x)\)</span> are pdf.Moreover <span class="math inline">\(f_1(x)\)</span> is standard normal distribution on (1,<span class="math inline">\(\infty\)</span>),<span class="math inline">\(f_2(x)\)</span> is gamma(3,1) distribution on (1,<span class="math inline">\(\infty\)</span>),we can get random numbers of them by using existing function in R.</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>qu <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">121</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>w1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(qu)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>est1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">g1</span>(w1))</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>sd1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(<span class="fu">g1</span>(w1))</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">21</span>)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>w2 <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(qu,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span><span class="sc">/</span>(<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span><span class="fu">exp</span>(x<span class="dv">-1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span>(x<span class="sc">^</span><span class="dv">2</span>))<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>est2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">g2</span>(w2))</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>sd2 <span class="ot">&lt;-</span> <span class="fu">sd</span>(<span class="fu">g2</span>(w2))</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>est1</span></code></pre></div>
<pre><code>## [1] 0.4037632</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>est2</span></code></pre></div>
<pre><code>## [1] 0.4002117</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>sd1</span></code></pre></div>
<pre><code>## [1] 1.135327</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>sd2</span></code></pre></div>
<pre><code>## [1] 0.4559141</code></pre>
<p>I guess the second function should produce the smaller variance in estimating the integral because the fluctuations in data is smaller in <span class="math inline">\(e^{x-\frac{1}{2}x^2}\)</span> than <span class="math inline">\({x^2}\)</span>. From the values of the estimation of variance for two function,we can see the second function performs better in variance.</p>
</div>
<div id="question-4" class="section level2">
<h2>Question 4</h2>
<p>Exercise 5.14:Obtain a Monte Carlo estimate of <span class="math inline">\(\int_{1}^{\infty} \frac{x^2}{\sqrt{2 \pi}}e^{-{x^2}/2} dx\)</span> by importance sampling.</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p>From the output in Question 3, we can get a Monte Carlo estimate of <span class="math inline">\(\int_{1}^{\infty} \frac{x^2}{\sqrt{2 \pi}}e^{-{x^2}/2} dx\)</span> by importance sampling is 0.400217.</p>
<p>#HW4 ## Question 1 Exercise 6.5:Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi_2(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<p>Estimate the coverage probability of the t-interval for random samples <span class="math inline">\(\chi_2(2)\)</span> data with sample size n = 20 by using a Monte Carlo experiment<br />
Algorithm flowchart<br />
1.specify seed,l(number of simulations),n <span class="math inline">\(\alpha\)</span>(confidence level)and true parameter value(<span class="math inline">\(\mu\)</span>)<br />
2.for i=1,…,l do<br />
(1)generate sample <span class="math inline">\(X_{i1},...,X_{in}\)</span>;<br />
(2)estimate <span class="math inline">\(\mu: \hat{\mu_i}=\bar{X_i}=\frac{1}{n}\sum_{j=1}^nX_{ij}\)</span> and the standard error of <span class="math inline">\(\hat{\mu}:\hat{se}_i= \frac{1}{n-1}\sum_{j=1}^n{(X_{ij}-\bar{X_i})}^{2}\)</span><br />
(3)construct the confidence interval <span class="math inline">\(C_i\)</span> for the i-th sample:<span class="math inline">\([\bar{X_i}-\frac{1}{\sqrt{n}}\hat{se_i}t_{1-\frac{\alpha}{2}}(n-1),\bar{X_i}-\frac{1}{\sqrt{n}}\hat{se_i}t_{\frac{\alpha}{2}}(n-1)]\)</span><br />
(4)compute <span class="math inline">\(m_i=I(\mu \in C_i)\)</span> for the i the sample<br />
3.compute the coverage probability: <span class="math inline">\(p=\frac{1}{l} \sum_{i=1}^l m_i\)</span></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>l<span class="ot">=</span><span class="fl">1e4</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">20</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>u<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">numeric</span>(l)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>l){</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">2</span>)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  c1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">-</span><span class="fu">sd</span>(x)<span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>a<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  c2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">-</span><span class="fu">sd</span>(x)<span class="sc">*</span><span class="fu">qt</span>(a<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(u<span class="sc">&lt;=</span>c2 <span class="sc">&amp;</span> u<span class="sc">&gt;=</span>c1) m[j]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> m[j]<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(m)</span></code></pre></div>
<pre><code>## [1] 0.9134</code></pre>
<p>From the value of output,we can know that the t-interval is more robust to departures from normality than the interval for variance.</p>
</div>
<div id="question-2-2" class="section level2">
<h2>Question 2</h2>
<p>Exercise 6.A:Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) <span class="math inline">\(\chi_2(1)\)</span>, (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test <span class="math inline">\(H_0\)</span> : <span class="math inline">\(\mu\)</span> = <span class="math inline">\(\mu_0\)</span> vs <span class="math inline">\(H_0\)</span> : <span class="math inline">\(\mu\)</span> = <span class="math inline">\(\mu_0\)</span>, where <span class="math inline">\(\mu_0\)</span> is the mean of <span class="math inline">\(\chi_2(1)\)</span>, Uniform(0,2), and Exponential(1), respectively.</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<p>Calculate the empirical Type I error rate of the test for the three distribution separately by using Monte Carlo simulation</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="do">##(1) chis-square distribution</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>cmu <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>l<span class="ot">=</span><span class="fl">1e2</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>hat.cmu <span class="ot">&lt;-</span>se.cmu <span class="ot">&lt;-</span> <span class="fu">numeric</span>()</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>pva1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>()</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>l){</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="dv">1</span>)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a> hat.cmu[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a> se.cmu[j] <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a> test.t <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x,<span class="at">mu=</span>cmu)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a> pva1[j] <span class="ot">&lt;-</span> test.t<span class="sc">$</span>p.value</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>pva2 <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">abs</span>(<span class="fu">sqrt</span>(n)<span class="sc">*</span>(hat.cmu<span class="sc">-</span>cmu)<span class="sc">/</span>se.cmu),<span class="at">df=</span>n<span class="dv">-1</span>))</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pva1<span class="sc">&lt;=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.15</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pva2<span class="sc">&lt;=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.15</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pva1<span class="sc">&lt;=</span><span class="fl">0.01</span>)</span></code></pre></div>
<pre><code>## [1] 0.09</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pva2<span class="sc">&lt;=</span><span class="fl">0.01</span>)</span></code></pre></div>
<pre><code>## [1] 0.09</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="do">##(2) uniform distribution on [0,2]</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>umu <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>l<span class="ot">=</span><span class="fl">1e2</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>hat.umu <span class="ot">&lt;-</span>se.umu <span class="ot">&lt;-</span> <span class="fu">numeric</span>()</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>pvb1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>()</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>l){</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="at">min=</span><span class="dv">0</span>,<span class="at">max=</span><span class="dv">2</span>)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a> hat.umu[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a> se.umu[j] <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a> test.t <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x,<span class="at">mu=</span>umu)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a> pvb1[j] <span class="ot">&lt;-</span> test.t<span class="sc">$</span>p.value</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>pvb2 <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">abs</span>(<span class="fu">sqrt</span>(n)<span class="sc">*</span>(hat.umu<span class="sc">-</span>umu)<span class="sc">/</span>se.umu),<span class="at">df=</span>n<span class="dv">-1</span>))</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pvb1<span class="sc">&lt;=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.1</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pvb2<span class="sc">&lt;=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.1</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pvb1<span class="sc">&lt;=</span><span class="fl">0.01</span>)</span></code></pre></div>
<pre><code>## [1] 0.02</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pvb2<span class="sc">&lt;=</span><span class="fl">0.01</span>)</span></code></pre></div>
<pre><code>## [1] 0.02</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="do">##(3) Exponential(rate=1)</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>emu <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>l<span class="ot">=</span><span class="fl">1e2</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>hat.emu <span class="ot">&lt;-</span>se.emu <span class="ot">&lt;-</span> <span class="fu">numeric</span>()</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>pvc1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>()</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>l){</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="at">min=</span><span class="dv">0</span>,<span class="at">max=</span><span class="dv">2</span>)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a> hat.emu[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a> se.emu[j] <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a> test.t <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x,<span class="at">mu=</span>emu)</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a> pvc1[j] <span class="ot">&lt;-</span> test.t<span class="sc">$</span>p.value</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>pvc2 <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">abs</span>(<span class="fu">sqrt</span>(n)<span class="sc">*</span>(hat.emu<span class="sc">-</span>emu)<span class="sc">/</span>se.emu),<span class="at">df=</span>n<span class="dv">-1</span>))</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pvc1<span class="sc">&lt;=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.03</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pvc2<span class="sc">&lt;=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.03</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pvc1<span class="sc">&lt;=</span><span class="fl">0.01</span>)</span></code></pre></div>
<pre><code>## [1] 0.01</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pvc2<span class="sc">&lt;=</span><span class="fl">0.01</span>)</span></code></pre></div>
<pre><code>## [1] 0.01</code></pre>
<p>From the output,we can see the empirical Type I error rate of the t-test of uniform distribution is closest to nominal significance level,the value corresponding to the exponential distribution is second,and the one of chis-square distribution is more different from the nominal value.<br />
The uniform distribution is symmetric while the other two is skewed distribution,so the difference of uniform one is more moderate because the t-test is robust to mild departure for normality.</p>
</div>
<div id="question-3-2" class="section level2">
<h2>Question 3</h2>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.<br />
(1) What is the corresponding hypothesis test problem?<br />
(2)What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?<br />
(3)Please provide the least necessary information for hypothesis testing.</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<p>(1)Suppose the power of two method as <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span>,the the corresponding hypothesis test problem is :<br />
<span class="math inline">\(H_0:p_1=p_2 \qquad H_1:p_1\neq p_2\)</span><br />
(2)Two-sample t-test can not be used because it demands independent samples.However,the two p-value from the same population,we can not guarantee the independence of two methods.When the number of sample is large enough,the mean value of significance test follows a normal distribution for z-test ans paired-t test,so the two methods can be used. McNemar test can be used because it is a nonparametric method which does not need to assume the exact distribution.<br />
(3)The significance of two method is needed to conduct the test.</p>
<p>#HW5 ## Question 1 Exercise 6.C: Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If X and Y are iid, the multivariate population skewness <span class="math inline">\(β_{1,d}\)</span> is defined by Mardia as <span class="math inline">\(\beta_{1,d}=E[(X-\mu)^T\Sigma^{-1}(Y-\mu)]^3\)</span>.<br />
Under normality,<span class="math inline">\(\beta_{1,d}=0\)</span>.The multivariate skewness statistic is <span class="math inline">\(b_{1,d}=\frac{1}{n^2}\sum_{i,j=1}^{n}((X_i-\bar{X})^T\hat{\Sigma^{-1}}(X_j-\bar{X}))^3\)</span>,<br />
where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance.Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(\frac{nb_{1,d}}{6}\)</span> is chisquared with d(d + 1)(d + 2)/6 degrees of freedom.</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<p>(1)repeat example 6.8<br />
I choose d=3,and <span class="math inline">\(\mu=(0,0,0)&#39;,\Sigma=\begin{pmatrix}1&amp;0&amp;0\\0&amp;1&amp;0\\0&amp;0&amp;1\\\end{pmatrix}\)</span></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="co">#write a function to calculate the value of the multivariate skewness statistic and judge if it reject the null hypothesis</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>bd <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  ns <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">ncol</span>(x)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> x</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>d){</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    y[,i]<span class="ot">=</span>x[,i]<span class="sc">-</span><span class="fu">mean</span>(x[,i])</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  sigmamax <span class="ot">&lt;-</span> <span class="fu">t</span>(y)<span class="sc">%*%</span>y<span class="sc">/</span>ns</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>  nsigmahat <span class="ot">&lt;-</span> <span class="fu">solve</span>(sigmamax)</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>  smatrix <span class="ot">&lt;-</span> y<span class="sc">%*%</span>nsigmahat<span class="sc">%*%</span><span class="fu">t</span>(y)</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  bvalue <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">rowSums</span>(smatrix<span class="sc">^</span><span class="dv">3</span>))<span class="sc">/</span>(ns<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  freedom <span class="ot">&lt;-</span> d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>  bound <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="fl">0.95</span>,freedom)</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  newb<span class="ot">=</span>ns<span class="sc">*</span>bvalue<span class="sc">/</span><span class="dv">6</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>  ifreject <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(newb<span class="sc">&gt;</span>bound)</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ifreject)</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a><span class="co"># set the parameter for sample of multiple-normal distribution</span></span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a><span class="co">#I set d=3</span></span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>setmean <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>setcov <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">ncol=</span><span class="dv">3</span>,<span class="at">nrow=</span><span class="dv">3</span>)</span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>nt<span class="ot">=</span><span class="fl">1e3</span><span class="co">#the number of repetition</span></span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>ns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>)<span class="co">#the vector of the number of sample </span></span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>nns <span class="ot">&lt;-</span> <span class="fu">length</span>(ns)</span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>probreject <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nns)</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">80512</span>)</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nns){</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>  prreject <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nt)</span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nt){</span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>samplex <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(ns[j],setmean,setcov)</span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>prreject[k] <span class="ot">&lt;-</span> <span class="fu">bd</span>(samplex)</span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a>probreject[j]<span class="ot">=</span><span class="fu">mean</span>(prreject)</span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a>ns <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(ns)</span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a>probreject </span></code></pre></div>
<pre><code>## [1] 0.040 0.039 0.056</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">as.integer</span>(ns),<span class="fu">round</span>(probreject,<span class="dv">3</span>))</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>table</span></code></pre></div>
<pre><code>##       [,1]   [,2]    [,3]
## [1,] 30.00 50.000 100.000
## [2,]  0.04  0.039   0.056</code></pre>
<p>According to the code,we can repeat the example 6.8.From the results of simulation,we can see the estimate of type I error is close to after the sample is larger than 100.<br />
</p>
<p>(2)repeat example 6.10<br />
I choose d=2,and <span class="math inline">\(\mu=(0,0)&#39;,\Sigma_1=\begin{pmatrix}1&amp;0\\0&amp;1\\\end{pmatrix},\Sigma_2=\begin{pmatrix}100&amp;0\\0&amp;100\\\end{pmatrix}\)</span><br />
The alternative is the multi-normal mixture denoted by<br />
<span class="math inline">\((1-\epsilon)MN(\mu,\Sigma_1)+\epsilon MN(\mu,\Sigma_2),\epsilon \in [0,1]\)</span></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">202110</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>setmean <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>proportion <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>,.<span class="dv">15</span>,.<span class="dv">01</span>),<span class="fu">seq</span>(.<span class="dv">16</span>,<span class="dv">1</span>,<span class="fl">0.05</span>))</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>np <span class="ot">&lt;-</span> <span class="fu">length</span>(proportion)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>proreject <span class="ot">&lt;-</span> <span class="fu">numeric</span>(np)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>nt<span class="ot">=</span><span class="fl">1e2</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>ns<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>setcov1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>setcov2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>),<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>np){</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>  bdt <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nt)</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>  pro <span class="ot">&lt;-</span> proportion[k]</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nt){</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>        U1 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(ns,setmean,setcov1)</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>        U2 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(ns,setmean,setcov2)</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>        v <span class="ot">&lt;-</span> <span class="fu">runif</span>(ns)</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>        t <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(v<span class="sc">&lt;</span><span class="dv">1</span><span class="sc">-</span>pro)</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>        samplex <span class="ot">&lt;-</span> t<span class="sc">*</span>U1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>t)<span class="sc">*</span>U2</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>        bdt[i] <span class="ot">&lt;-</span> <span class="fu">bd</span>(samplex)</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>proreject[k] <span class="ot">&lt;-</span> <span class="fu">mean</span>(bdt)</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>proreject</span></code></pre></div>
<pre><code>##  [1] 0.03 0.60 0.87 0.96 0.96 0.98 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.97 1.00
## [16] 1.00 1.00 0.97 0.95 0.91 0.90 0.82 0.78 0.64 0.48 0.51 0.44 0.25 0.20 0.24
## [31] 0.14 0.08 0.02</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot power vs epsilon</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(proportion,proreject,<span class="at">type =</span> <span class="st">&#39;b&#39;</span>,<span class="at">xlab=</span><span class="fu">bquote</span>(epsilon),<span class="at">ylab=</span><span class="st">&quot;power&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">0.1</span>,<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>hatse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(proreject<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>proreject)<span class="sc">/</span>nt)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(proportion, proreject<span class="sc">+</span>hatse,<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(proportion,proreject<span class="sc">-</span>hatse,<span class="at">lty=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>According the code above,we can repeat the example 6.10.The empirical power curve is shown in the plot.The simulation results suggest that the power of the test is greater than 0.10 for 0&lt;<span class="math inline">\(\epsilon\)</span>&lt;0.9 and highest when <span class="math inline">\(\epsilon\)</span> is about 0.15.</p>
<p>#HW6 ## Question 1 Exercise 7.7:Refer to Exercise 7.6. Efron and Tibshirani discuss the following example.The five-dimensional scores data have a 5 × 5 covariance matrix <span class="math inline">\(\Sigma\)</span>,with positive eigenvalues <span class="math inline">\(\lambda_1\)</span> &gt; ··· &gt; <span class="math inline">\(\lambda_5\)</span>. In principal components analysis, <span class="math inline">\(\theta=\frac{\lambda_1}{\sum_{j=1}^{5}\lambda_j}\)</span> measures the proportion of variance explained by the first principal component. Let <span class="math inline">\(\hat{\lambda_1}&gt;...&gt;\hat{\lambda_5}\)</span> be the eigenvalues of <span class="math inline">\(\hat{\Sigma}\)</span>,where <span class="math inline">\(\hat{\Sigma}\)</span> is the MLE of <span class="math inline">\(\Sigma\)</span>. Compute the sample estimate <span class="math inline">\(\hat{\theta}=\frac{\hat{\lambda_1}}{\sum_{j=1}^{5}\hat{\lambda_j}}\)</span> of <span class="math inline">\(\theta\)</span>.Use bootstrap to estimate the bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<p>(1)Compute the sample estimate <span class="math inline">\(\hat{\theta}\)</span>: i)get the MLE of <span class="math inline">\(\Sigma\)</span>:<span class="math inline">\(\hat{\Sigma}=\frac{n-1}{n}cov(X)\)</span>,cov(x) is the sample covariance matrix.<br />
ii)get the eigenvalues of <span class="math inline">\(\hat{\Sigma}\)</span>:<span class="math inline">\(\hat{\lambda_1},...,\hat{\lambda_5}\)</span> and <span class="math inline">\(\hat{\lambda_1}&gt;...&gt;\hat{\lambda_5}\)</span><br />
iii)compute the sample estimate <span class="math inline">\(\hat{\theta}=\frac{\hat{\lambda_1}}{\sum_{j=1}^{5}\hat{\lambda_j}}\)</span>.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scor,<span class="at">package =</span> <span class="st">&quot;bootstrap&quot;</span>)<span class="co"># load the data</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">*</span><span class="fu">cov</span>(scor) <span class="co">#the MLE of covariance matrix</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma)<span class="sc">$</span>values</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>theta_hat <span class="ot">&lt;-</span> lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(theta_hat)</span></code></pre></div>
<pre><code>## [1] 0.619115</code></pre>
<p>From the output, we can see the sample estimate <span class="math inline">\(\hat{\theta}\)</span> is 0.619115.<br />
</p>
<p>(2)Use bootstrap to estimate the bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.<br />
</p>
<p>The bootstrap estimate of the standard error of <span class="math inline">\(\hat{\theta}\)</span> is the stand error of bootstrap sample. <span class="math inline">\(\hat{se}_B=\sqrt{\frac{1}{B}\sum_{b=1}^{B}(\hat{\theta^{(b)}}-\bar{\hat{\theta}^*})^2}\)</span>.<br />
B represents the number of sample,<span class="math inline">\(\hat{\theta^{(b)}}\)</span> is the estimate of <span class="math inline">\(\theta\)</span> of the bth sample,<span class="math inline">\(\bar{\hat{\theta}^*}=\frac{1}{B}\sum_{b=1}^{B}\hat{\theta^{(b)}}\)</span>.<br />
The the bootstrap estimate of bias of <span class="math inline">\(\hat{\theta}\)</span> is the difference of bootstrap estimate and sample estimate. <span class="math inline">\(\hat{bias_B(\hat{\theta})}=\bar{\hat{\theta}^*}-\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scor,<span class="at">package =</span> <span class="st">&quot;bootstrap&quot;</span>)<span class="co"># load the data</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>theta.b <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1029</span>)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="at">size=</span>n,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  mech <span class="ot">&lt;-</span> scor<span class="sc">$</span>mec[j]</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  vect <span class="ot">&lt;-</span> scor<span class="sc">$</span>vec[j]</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  alge <span class="ot">&lt;-</span> scor<span class="sc">$</span>alg[j]</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>  anal <span class="ot">&lt;-</span> scor<span class="sc">$</span>ana[j]</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>  stat <span class="ot">&lt;-</span> scor<span class="sc">$</span>sta[j]</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>  da <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mech,vect,alge,anal,stat)</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>  bsigma <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">*</span><span class="fu">cov</span>(da)</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>  blambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(bsigma)<span class="sc">$</span>values</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>  theta.b[i] <span class="ot">&lt;-</span> blambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(blambda)</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>bbias <span class="ot">&lt;-</span> <span class="fu">mean</span>(theta.b)<span class="sc">-</span>theta_hat</span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>bbias</span></code></pre></div>
<pre><code>## [1] 0.002054937</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>bsdhat <span class="ot">&lt;-</span> <span class="fu">sd</span>(theta.b)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>bsdhat</span></code></pre></div>
<pre><code>## [1] 0.04817344</code></pre>
<p>By using bootstrap, we can get the estimate of the bias of <span class="math inline">\(\hat{\theta}\)</span> is 0.002054, and the estimate of the standard error of <span class="math inline">\(\hat{\theta}\)</span> is 0.048173.</p>
</div>
<div id="question-2-3" class="section level2">
<h2>Question 2</h2>
<p>Exercise 7.8: Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<p>The jackknife estimate of bias of <span class="math inline">\(\hat{\theta}\)</span> is: <span class="math inline">\(bias_{jack}=(n-1)(\bar{\hat{\theta}_{(.)}}-\hat{\theta})\)</span>.<br />
<span class="math inline">\(\hat{\theta_{(i)}}\)</span> is the ith jackknife estimate. <span class="math inline">\(\bar{\hat{\theta_{(.)}}}=\frac{1}{n}\sum_{i=1}^{n}\hat{\theta_{(i)}}\)</span>, represents the mean of jackknife estimate. The jackknife estimate of standard error of <span class="math inline">\(\hat{\theta}\)</span> is:<span class="math inline">\(\hat{se}_{jack}=\sqrt{\frac{n-1}{n}\sum_{i=1}^{n}(\hat{\theta_{(i)}}-\bar{\hat{\theta}_{(.)}})^2}\)</span>.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  da <span class="ot">&lt;-</span> scor[<span class="sc">-</span>i,]</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  newsigma <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">*</span><span class="fu">cov</span>(da)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  newlambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(newsigma)<span class="sc">$</span>values</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  theta.jack[i] <span class="ot">&lt;-</span> newlambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(newlambda)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>jbias <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta_hat)</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(jbias)</span></code></pre></div>
<pre><code>## [1] 0.001069139</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>sdhat <span class="ot">&lt;-</span> ((n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n))<span class="sc">*</span><span class="fu">sd</span>(theta.jack)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sdhat)</span></code></pre></div>
<pre><code>## [1] 0.04955231</code></pre>
<p>From the output,we can get the jackknife estimate of bias of <span class="math inline">\(\hat{\theta}\)</span> is 0.001069,the stanard error estimate is 0.049552.</p>
</div>
<div id="question-3-3" class="section level2">
<h2>Question 3</h2>
<p>Exercise 7.9: Refer to Exercise 7.7.Compute 95% percentile and BCa confidence intervals for <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-13" class="section level2">
<h2>Answer</h2>
<p>Percentile CI (<a href>percent</a>) by assuming <span class="math inline">\(\hat\theta^*\)</span> and <span class="math inline">\(\hat\theta\)</span> have approximately the same distribution: <span class="math display">\[(\hat\theta^*_{\alpha/2},\hat\theta^*_{1-\alpha/2}).\]</span><br />
Bias-corrected and accelerated CI (<a href>BCa</a>): <span class="math display">\[(\hat\theta^*_{\alpha_1},\hat\theta^*_{\alpha_2})\]</span> <span class="math display">\[\alpha_1=\Phi(z_0+\frac{z_0+z_{\alpha/2}}{1-\hat a (z_0+z_{\alpha/2})}), \alpha_2=\Phi(z_0+\frac{z_0+z_{1-\alpha/2}}{1-\hat a (z_0+z_{1-\alpha/2})})\]</span> <span class="math display">\[\hat z_0=\Phi^{-1}\left(\frac1B\sum_{b=1}^BI(\hat\theta^{(b)}&lt;\hat\theta)\right), 
        \hat a=\frac{\sum_{i=1}^n(\bar{\theta_{(\cdot)}}-\theta_{i})^3} {6\sum_{i=1}^n((\bar{\theta_{(\cdot)}}-\theta_{i})^2)^{3/2}}\]</span></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scor,<span class="at">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">nrow</span>(scor)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e2</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>theta.b <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1029</span>)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>km<span class="ot">=</span><span class="fl">1e2</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>percent1 <span class="ot">&lt;-</span> percent2 <span class="ot">&lt;-</span> bca1 <span class="ot">&lt;-</span> bca2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(km)</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>km){</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="at">size=</span>n,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>  mech <span class="ot">&lt;-</span> scor<span class="sc">$</span>mec[j]</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>  vect <span class="ot">&lt;-</span> scor<span class="sc">$</span>vec[j]</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>  alge <span class="ot">&lt;-</span> scor<span class="sc">$</span>alg[j]</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>  anal <span class="ot">&lt;-</span> scor<span class="sc">$</span>ana[j]</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>  stat <span class="ot">&lt;-</span> scor<span class="sc">$</span>sta[j]</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>  da <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mech,vect,alge,anal,stat)</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>  bsigma <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">*</span><span class="fu">cov</span>(da)</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>  blambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(bsigma)<span class="sc">$</span>values</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>  theta.b[i] <span class="ot">&lt;-</span> blambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(blambda)</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a><span class="do">##percentile c.i.</span></span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>percent1[k]<span class="ot">=</span><span class="fu">quantile</span>(theta.b,<span class="fl">0.25</span>)</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>percent2[k]<span class="ot">=</span><span class="fu">quantile</span>(theta.b,<span class="fl">0.975</span>)</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a><span class="do">## bca c.i.</span></span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>a1<span class="ot">=</span><span class="fu">sum</span>((<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.jack)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>thetanew<span class="ot">&lt;-</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.jack)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>a2<span class="ot">=</span><span class="fu">sum</span>(thetanew<span class="sc">^</span><span class="fl">1.5</span>)</span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span>a1<span class="sc">/</span>a2</span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="fu">mean</span>(theta.b<span class="sc">&lt;</span>theta_hat)</span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a>hatz0<span class="ot">=</span><span class="fu">qnorm</span>(b)</span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">qnorm</span>(<span class="fl">0.25</span>)</span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a>c1<span class="ot">=</span>z<span class="sc">+</span>hatz0</span>
<span id="cb84-35"><a href="#cb84-35" aria-hidden="true" tabindex="-1"></a>c2<span class="ot">=</span>hatz0<span class="sc">-</span>z</span>
<span id="cb84-36"><a href="#cb84-36" aria-hidden="true" tabindex="-1"></a>d1<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">*</span>c1</span>
<span id="cb84-37"><a href="#cb84-37" aria-hidden="true" tabindex="-1"></a>d2<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">*</span>c2</span>
<span id="cb84-38"><a href="#cb84-38" aria-hidden="true" tabindex="-1"></a>a1value<span class="ot">=</span><span class="fu">pnorm</span>(hatz0<span class="sc">+</span>c1<span class="sc">/</span>d1)</span>
<span id="cb84-39"><a href="#cb84-39" aria-hidden="true" tabindex="-1"></a>a2value<span class="ot">=</span><span class="fu">pnorm</span>(hatz0<span class="sc">+</span>c2<span class="sc">/</span>d2)</span>
<span id="cb84-40"><a href="#cb84-40" aria-hidden="true" tabindex="-1"></a>bca1[k]<span class="ot">=</span><span class="fu">quantile</span>(theta.b,a1value)</span>
<span id="cb84-41"><a href="#cb84-41" aria-hidden="true" tabindex="-1"></a>bca2[k]<span class="ot">=</span><span class="fu">quantile</span>(theta.b,a2value)</span>
<span id="cb84-42"><a href="#cb84-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb84-43"><a href="#cb84-43" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(percent1)</span></code></pre></div>
<pre><code>## [1] 0.5890301</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(percent2)</span></code></pre></div>
<pre><code>## [1] 0.7047428</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(bca1)</span></code></pre></div>
<pre><code>## [1] 0.5922508</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(bca2)</span></code></pre></div>
<pre><code>## [1] 0.661033</code></pre>
<p>From the output, we can get the 95% percentile confidence interval for <span class="math inline">\(\hat{\theta}\)</span> is [0.5891679,0.707769], the 95% bca confidence interval is [0.5930304,0.6609741].</p>
</div>
<div id="question-4-1" class="section level2">
<h2>Question 4</h2>
<p>Exercise 7.B:Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi^2(5)\)</span> distributions (positive skewness).</p>
</div>
<div id="answer-14" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>skness <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i){</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  barx <span class="ot">&lt;-</span> <span class="fu">mean</span>(x[i,])</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  hatm2 <span class="ot">=</span><span class="fu">mean</span>((x[i,]<span class="sc">-</span>barx)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  hatm3<span class="ot">=</span><span class="fu">mean</span>((x[i,]<span class="sc">-</span>barx)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(hatm3<span class="sc">/</span>hatm2<span class="sc">^</span><span class="fl">1.5</span>)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="co">#normal population</span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>sknorm<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>l<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>times<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>cinormb<span class="ot">&lt;-</span>cinormbasic<span class="ot">&lt;-</span>cinormperc<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,times,<span class="dv">2</span>)</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1122</span>)</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>times){</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>spnorm <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">rnorm</span>(l))</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>spnorm.b <span class="ot">&lt;-</span> <span class="fu">boot</span>(spnorm,<span class="at">statistic=</span>skness,<span class="at">R=</span><span class="dv">100</span>)</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>normb.ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(spnorm.b,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>cinormb[i,]<span class="ot">&lt;-</span>normb.ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>cinormbasic[i,]<span class="ot">&lt;-</span>normb.ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a>cinormperc[i,]<span class="ot">&lt;-</span>normb.ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true" tabindex="-1"></a>norm.norm <span class="ot">=</span><span class="fu">mean</span>(cinormb[,<span class="dv">1</span>]<span class="sc">&lt;=</span>sknorm <span class="sc">&amp;</span> cinormb[,<span class="dv">2</span>]<span class="sc">&gt;=</span>sknorm)</span>
<span id="cb92-23"><a href="#cb92-23" aria-hidden="true" tabindex="-1"></a>basic.norm <span class="ot">=</span><span class="fu">mean</span>(cinormbasic[,<span class="dv">1</span>]<span class="sc">&lt;=</span>sknorm <span class="sc">&amp;</span> cinormbasic[,<span class="dv">2</span>]<span class="sc">&gt;=</span>sknorm)</span>
<span id="cb92-24"><a href="#cb92-24" aria-hidden="true" tabindex="-1"></a>percentile.norm<span class="ot">=</span><span class="fu">mean</span>(cinormperc[,<span class="dv">1</span>]<span class="sc">&lt;=</span>sknorm <span class="sc">&amp;</span> cinormperc[,<span class="dv">2</span>]<span class="sc">&gt;=</span>sknorm)</span>
<span id="cb92-25"><a href="#cb92-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;norm.norm =&#39;</span>,norm.norm,<span class="st">&#39;basic.norm =&#39;</span>,basic.norm,<span class="st">&#39;percentile.norm=&#39;</span>,percentile.norm)</span></code></pre></div>
<pre><code>## norm.norm = 0.91 basic.norm = 0.92 percentile.norm= 0.96</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>missnorml<span class="ot">=</span><span class="fu">mean</span>(cinormb[,<span class="dv">1</span>]<span class="sc">&gt;</span>sknorm)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>missnormr<span class="ot">=</span><span class="fu">mean</span>(cinormb[,<span class="dv">2</span>]<span class="sc">&lt;</span>sknorm)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>missbcal<span class="ot">=</span><span class="fu">mean</span>(cinormbasic[,<span class="dv">1</span>]<span class="sc">&gt;</span>sknorm)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>missbcar<span class="ot">=</span><span class="fu">mean</span>(cinormbasic[,<span class="dv">2</span>]<span class="sc">&lt;</span>sknorm)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>misspercl<span class="ot">=</span><span class="fu">mean</span>(cinormperc[,<span class="dv">1</span>]<span class="sc">&gt;</span>sknorm)</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>misspercr<span class="ot">=</span><span class="fu">mean</span>(cinormperc[,<span class="dv">2</span>]<span class="sc">&lt;</span>sknorm)</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>missleft.norm <span class="ot">&lt;-</span> <span class="fu">c</span>(missnorml,missbcal,misspercl)</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>missright.norm <span class="ot">&lt;-</span> <span class="fu">c</span>(missnormr,missbcar,misspercr)</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>miss.norm <span class="ot">&lt;-</span> <span class="fu">cbind</span>(missleft.norm,missright.norm)</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(miss.norm)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;bca&quot;</span>,<span class="st">&quot;percentile&quot;</span>)</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>miss.norm</span></code></pre></div>
<pre><code>##            missleft.norm missright.norm
## norm                0.06           0.03
## bca                 0.05           0.03
## percentile          0.04           0.00</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="do">##chisquare population</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>skchi<span class="ot">=</span><span class="fu">sqrt</span>(<span class="dv">8</span><span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>l<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>times<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>cichib<span class="ot">&lt;-</span>cichibasic<span class="ot">&lt;-</span>cichiperc<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,times,<span class="dv">2</span>)</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1022</span>)</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>times){</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>spchi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">rchisq</span>(l,<span class="dv">5</span>))</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>spchi.b <span class="ot">&lt;-</span> <span class="fu">boot</span>(spchi,<span class="at">statistic=</span>skness,<span class="at">R=</span><span class="dv">100</span>)</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>chib.ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(spchi.b,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>cichib[i,]<span class="ot">&lt;-</span>chib.ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>cichibasic[i,]<span class="ot">&lt;-</span>chib.ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>cichiperc[i,]<span class="ot">&lt;-</span>chib.ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>norm.chi <span class="ot">=</span><span class="fu">mean</span>(cichib[,<span class="dv">1</span>]<span class="sc">&lt;=</span>skchi <span class="sc">&amp;</span> cichib[,<span class="dv">2</span>]<span class="sc">&gt;=</span>skchi)</span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>basic.chi <span class="ot">=</span><span class="fu">mean</span>(cichibasic[,<span class="dv">1</span>]<span class="sc">&lt;=</span>skchi <span class="sc">&amp;</span> cichibasic[,<span class="dv">2</span>]<span class="sc">&gt;=</span>skchi)</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>percentile.chi<span class="ot">=</span><span class="fu">mean</span>(cichiperc[,<span class="dv">1</span>]<span class="sc">&lt;=</span>skchi <span class="sc">&amp;</span> cichiperc[,<span class="dv">2</span>]<span class="sc">&gt;=</span>skchi)</span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;norm.chi =&#39;</span>,norm.chi,</span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;basic.chi =&#39;</span>,basic.chi,</span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;percentile.chi=&#39;</span>,percentile.chi)</span></code></pre></div>
<pre><code>## norm.chi = 0.72 basic.chi = 0.69 percentile.chi= 0.76</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>missnorml1<span class="ot">=</span><span class="fu">mean</span>(cichib[,<span class="dv">1</span>]<span class="sc">&gt;</span>skchi)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>missnormr1<span class="ot">=</span><span class="fu">mean</span>(cichib[,<span class="dv">2</span>]<span class="sc">&lt;</span>skchi)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>missbcal1<span class="ot">=</span><span class="fu">mean</span>(cichibasic[,<span class="dv">1</span>]<span class="sc">&gt;</span>skchi)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>missbcar1<span class="ot">=</span><span class="fu">mean</span>(cichibasic[,<span class="dv">2</span>]<span class="sc">&lt;</span>skchi)</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>misspercl1<span class="ot">=</span><span class="fu">mean</span>(cichiperc[,<span class="dv">1</span>]<span class="sc">&gt;</span>skchi)</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>misspercr1<span class="ot">=</span><span class="fu">mean</span>(cichiperc[,<span class="dv">2</span>]<span class="sc">&lt;</span>skchi)</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>missleft.chi<span class="ot">&lt;-</span> <span class="fu">c</span>(missnorml1,missbcal1,misspercl1)</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>missright.chi <span class="ot">&lt;-</span> <span class="fu">c</span>(missnormr1,missbcar1,misspercr1)</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>miss.chi <span class="ot">&lt;-</span> <span class="fu">cbind</span>(missleft.chi,missright.chi)</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(miss.chi)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;bca&quot;</span>,<span class="st">&quot;percentile&quot;</span>)</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>miss.chi</span></code></pre></div>
<pre><code>##            missleft.chi missright.chi
## norm               0.05          0.23
## bca                0.07          0.24
## percentile         0.00          0.24</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>difference <span class="ot">&lt;-</span> <span class="fu">c</span>(norm.norm<span class="sc">-</span>norm.chi,basic.norm<span class="sc">-</span>basic.chi,percentile.norm<span class="sc">-</span>percentile.chi)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>difference</span></code></pre></div>
<pre><code>## [1] 0.19 0.23 0.20</code></pre>
<p>From the output, we can see the coverage rates for normal populations are bigger than the <span class="math inline">\(\chi^2(5)\)</span> distribution.The difference is more than 7%,and the biggest one is almost 10%,which means the distribution of sample has a deep influence on the coverage rate of confidence interval.</p>
<p>#HW7 ## Question 1 Exercise 8.2:Implement the bivariate Spearman rank correlation test for independence[255] as a permutation test. The Spearman rank correlation test statistic can be obtained from function cor with method = “spearman”. Compare the achieved significance level of the permutation test with the p-value reported by cor.test on the same samples.</p>
</div>
<div id="answer-15" class="section level2">
<h2>Answer</h2>
<p>Permutation test procedure:<br />
1.compute the observed test statistic:<span class="math inline">\(\hat{\theta}\)</span><br />
2.for each replicate,indexed b=1,…,B: (a)generate a sample by random permutation<br />
(b)compute the statistic:<span class="math inline">\(\hat{\theta^{(b)}}\)</span><br />
3.compute the empirical p-value:<br />
<span class="math inline">\(\hat{p}=\frac{1+\sum_{b=1}^{B}I(|\hat{\theta^{(b)}|}&gt;=|\hat{\theta}|)}{B+1}\)</span></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>mpg2<span class="ot">=</span><span class="fu">c</span>(<span class="fl">21.0</span>,<span class="fl">22.8</span>,<span class="fl">21.4</span> ,<span class="fl">18.7</span>, <span class="fl">18.1</span>, <span class="fl">14.3</span>, <span class="fl">24.4</span>, <span class="fl">19.2</span>, <span class="fl">17.3</span> ,<span class="fl">15.2</span> ,<span class="fl">10.4</span>, <span class="fl">14.7</span>, <span class="fl">32.4</span> ,<span class="fl">30.4</span>,<span class="fl">33.9</span>,<span class="fl">21.5</span>, <span class="fl">15.5</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>wt2<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">2.620</span>,<span class="fl">2.320</span>,<span class="fl">3.215</span> ,<span class="fl">3.440</span>, <span class="fl">3.460</span>, <span class="fl">3.570</span>, <span class="fl">3.190</span>,<span class="fl">3.780</span>, <span class="fl">4.070</span>, <span class="fl">3.730</span> ,<span class="fl">5.280</span>, <span class="fl">5.424</span>,<span class="fl">5.345</span>, <span class="fl">2.200</span>, <span class="fl">1.615</span>, <span class="fl">1.835</span>, <span class="fl">2.465</span>)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>ns<span class="ot">=</span><span class="fu">length</span>(mpg2)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>initial <span class="ot">&lt;-</span> <span class="fu">cor</span>(mpg2,wt2,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>nt<span class="ot">=</span><span class="fl">1e3</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>simulation <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nt)</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nt){</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>  newmpg <span class="ot">&lt;-</span> <span class="fu">sample</span>(mpg2,<span class="at">size=</span>ns,<span class="at">replace=</span>F)</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>  newwt<span class="ot">&lt;-</span> <span class="fu">sample</span>(wt2,<span class="at">size=</span>ns,<span class="at">replace=</span>F)</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>  simulation[i]<span class="ot">=</span><span class="fu">cor</span>(newmpg,newwt,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>simu<span class="ot">=</span><span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(initial,simulation))<span class="sc">&gt;=</span><span class="fu">abs</span>(initial))</span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>exsit<span class="ot">=</span><span class="fu">cor.test</span>(mpg2,wt2,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(simu,exsit),<span class="dv">6</span>)</span></code></pre></div>
<pre><code>## [1] 0.018981 0.018507</code></pre>
<p>From the output of empirical p-value,we can reject <span class="math inline">\(H_0\)</span> at significance level <span class="math inline">\(\alpha\)</span>=0.05 because <span class="math inline">\(\hat{p}&lt;\alpha\)</span>.Besides,the achieved significance level of the permutation test is close to the p-value reported by cor.test on the same samples according to the result.</p>
</div>
<div id="question-2-4" class="section level2">
<h2>Question 2</h2>
<p>Design experiments for evaluating the performance of the NN,energy,and ball methods in various situations.<br />
</p>
<p>(1)Unequal variances and equal expectations<br />
(2)Unequal variances and unequal expectations<br />
(3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)<br />
(4)Unbalanced samples (say, 1 case versus 10 controls)<br />
Note: The parameters should be chosen such that the powers are distinguishable (say,range from 0.3 to 0.8)</p>
</div>
<div id="answer-16" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;Ball&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     bd</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>statn <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ix, ns,k) {</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  la <span class="ot">&lt;-</span> ns[<span class="dv">1</span>]; lb <span class="ot">&lt;-</span> ns[<span class="dv">2</span>]; l <span class="ot">&lt;-</span> la <span class="sc">+</span> lb</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>(x)) x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x,<span class="dv">0</span>);</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x[ix, ];</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>  NN <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>x, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>  regiona <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>la,<span class="sc">-</span><span class="dv">1</span>] </span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>  regionb <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[(la<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>l,<span class="sc">-</span><span class="dv">1</span>] </span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>  ia <span class="ot">&lt;-</span> <span class="fu">sum</span>(regiona <span class="sc">&lt;</span> la<span class="fl">+.5</span>);ib <span class="ot">&lt;-</span> <span class="fu">sum</span>(regionb <span class="sc">&gt;</span>lb<span class="fl">+.5</span>) </span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>  (ia<span class="sc">+</span>ib)<span class="sc">/</span>(k<span class="sc">*</span>l)</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>test.nn<span class="ot">&lt;-</span> <span class="cf">function</span>(z,ns,k){</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>  simu.boot <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic=</span>statn,<span class="at">R=</span>R,</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">ns =</span> ns,<span class="at">k=</span>k)</span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>  st <span class="ot">&lt;-</span> <span class="fu">c</span>(simu.boot<span class="sc">$</span>t0,simu.boot<span class="sc">$</span>t)</span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>  pvalue <span class="ot">&lt;-</span> <span class="fu">mean</span>(st<span class="sc">&gt;=</span>st[<span class="dv">1</span>])</span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">statistic=</span>st[<span class="dv">1</span>],<span class="at">p.value=</span>pvalue)</span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>nsimu <span class="ot">&lt;-</span> <span class="fl">1e2</span>; k<span class="ot">&lt;-</span><span class="dv">3</span>; p<span class="ot">&lt;-</span><span class="dv">2</span>; </span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1199</span>)</span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a>nx<span class="ot">&lt;-</span>ny <span class="ot">&lt;-</span> <span class="dv">30</span>;n <span class="ot">&lt;-</span> nx<span class="sc">+</span>ny; N <span class="ot">=</span> <span class="fu">c</span>(nx,ny)</span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a>nt<span class="ot">&lt;-</span><span class="dv">100</span>; R<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a>pvalue <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,nsimu,<span class="dv">3</span>)</span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsimu){</span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a>  xsample <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(nx<span class="sc">*</span>p,<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="at">ncol=</span>p);</span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a>  ysample <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rnorm</span>(ny),<span class="fu">rnorm</span>(ny));</span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a>  ztest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(xsample,ysample)</span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">test.nn</span>(ztest,N,k)<span class="sc">$</span>p.value</span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(ztest,<span class="at">sizes=</span>N,<span class="at">R=</span>nt)<span class="sc">$</span>p.value</span>
<span id="cb107-33"><a href="#cb107-33" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>xsample,<span class="at">y=</span>ysample,<span class="at">num.permutations=</span><span class="dv">100</span>,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">1122</span>)<span class="sc">$</span>p.value</span>
<span id="cb107-34"><a href="#cb107-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-35"><a href="#cb107-35" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>; </span>
<span id="cb107-36"><a href="#cb107-36" aria-hidden="true" tabindex="-1"></a>getpower1 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(pvalue<span class="sc">&lt;</span>alpha)</span>
<span id="cb107-37"><a href="#cb107-37" aria-hidden="true" tabindex="-1"></a>getpower <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(getpower1,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">row.names=</span><span class="fu">c</span>(<span class="st">&quot;NN&quot;</span>,<span class="st">&#39;Energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>))</span>
<span id="cb107-38"><a href="#cb107-38" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(getpower)<span class="ot">=</span><span class="st">&quot;p-value&quot;</span></span>
<span id="cb107-39"><a href="#cb107-39" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(getpower)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NN</td>
<td align="right">0.42</td>
</tr>
<tr class="even">
<td align="left">Energy</td>
<td align="right">0.36</td>
</tr>
<tr class="odd">
<td align="left">Ball</td>
<td align="right">0.81</td>
</tr>
</tbody>
</table>
<p>(1)I set the <span class="math inline">\(n_1=n_2=30\)</span>,<span class="math inline">\(\mu_1=\mu_2=0\)</span>,<span class="math inline">\(\sigma_1=1.5,\sigma_2=1\)</span>.From the output, we can see the power of Ball test is much bigger than energy test and NN test, which means it is more powerful .</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>nsimu2 <span class="ot">&lt;-</span> <span class="dv">100</span>; k<span class="ot">&lt;-</span><span class="dv">3</span>; p<span class="ot">&lt;-</span><span class="dv">2</span>; u<span class="ot">=</span><span class="fl">0.5</span>;<span class="fu">set.seed</span>(<span class="dv">1199</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>nx <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span> <span class="dv">10</span>; nt<span class="ot">&lt;-</span><span class="dv">100</span>; n <span class="ot">&lt;-</span> nx<span class="sc">+</span>ny; Nc <span class="ot">=</span> <span class="fu">c</span>(nx,ny)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>pvalue <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,nsimu2,<span class="dv">3</span>)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsimu2){</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>  xsample <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(nx<span class="sc">*</span>p,<span class="dv">0</span>,<span class="fl">1.2</span>),<span class="at">ncol=</span>p);</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>  ysample <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rnorm</span>(ny),<span class="fu">rnorm</span>(ny,u));</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>  ztest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(xsample,ysample)</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">test.nn</span>(ztest,Nc,k)<span class="sc">$</span>p.value</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(ztest,<span class="at">sizes=</span>Nc,<span class="at">R=</span>nt)<span class="sc">$</span>p.value</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>xsample,<span class="at">y=</span>ysample,<span class="at">num.permutations=</span><span class="fl">1e2</span>,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">2120</span>)<span class="sc">$</span>p.value</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>; </span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>getpower2 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(pvalue<span class="sc">&lt;</span>alpha)</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>getpower <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(getpower2,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">row.names=</span><span class="fu">c</span>(<span class="st">&quot;NN&quot;</span>,<span class="st">&#39;Energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>))</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(getpower)<span class="ot">=</span><span class="st">&quot;p-value&quot;</span></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(getpower)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NN</td>
<td align="right">0.11</td>
</tr>
<tr class="even">
<td align="left">Energy</td>
<td align="right">0.38</td>
</tr>
<tr class="odd">
<td align="left">Ball</td>
<td align="right">0.25</td>
</tr>
</tbody>
</table>
<p>(2)I set the <span class="math inline">\(n_1=n_2=60\)</span>,<span class="math inline">\(\mu_1=0,\mu_2=0.5\)</span>,<span class="math inline">\(\sigma_1=1.2,\sigma_2=1\)</span>.From the output, we can see the power of energy test and Ball test are much bigger than NN test, which means they are more powerful than nearest NN test.Besides,the Ball test performs best.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>nsimu3 <span class="ot">&lt;-</span> <span class="dv">100</span>; k<span class="ot">&lt;-</span><span class="dv">3</span>; p<span class="ot">&lt;-</span><span class="dv">2</span>; u<span class="ot">=</span><span class="fl">0.5</span>;<span class="fu">set.seed</span>(<span class="dv">1199</span>)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span> <span class="dv">10</span>; nt<span class="ot">&lt;-</span><span class="fl">1e2</span>; n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2; N <span class="ot">=</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>pvalue <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,nsimu3,<span class="dv">3</span>)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsimu3){</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  xsample <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rt</span>(n1<span class="sc">*</span>p,<span class="dv">1</span>),<span class="at">ncol=</span>p);</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a> U1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a> U2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2,<span class="at">mean=</span><span class="dv">3</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a> v1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n2)</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a> t1 <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(v1<span class="sc">&lt;</span><span class="fl">0.7</span>)</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a> U <span class="ot">&lt;-</span> t1<span class="sc">*</span>U1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>t1)<span class="sc">*</span>U2</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a> U3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a> U4 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2,<span class="at">mean=</span><span class="dv">3</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a> v2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n2)</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a> t2 <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(v2<span class="sc">&lt;</span><span class="fl">0.7</span>)</span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a> V <span class="ot">&lt;-</span> t2<span class="sc">*</span>U3<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>t2)<span class="sc">*</span>U4</span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a> ysample <span class="ot">&lt;-</span> <span class="fu">cbind</span>(U,V);</span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>  ztest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(xsample,ysample)</span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">test.nn</span>(ztest,N,k)<span class="sc">$</span>p.value</span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(ztest,<span class="at">sizes=</span>N,<span class="at">R=</span>nt)<span class="sc">$</span>p.value</span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>xsample,<span class="at">y=</span>ysample,<span class="at">num.permutations=</span><span class="fl">1e3</span>,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">1122</span>)<span class="sc">$</span>p.value</span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>; </span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a>getpower3 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(pvalue<span class="sc">&lt;</span>alpha)</span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a>getpower <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(getpower3,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">row.names=</span><span class="fu">c</span>(<span class="st">&quot;NN&quot;</span>,<span class="st">&#39;Energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>))</span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(getpower)<span class="ot">=</span><span class="st">&quot;p-value&quot;</span></span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(getpower)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NN</td>
<td align="right">0.16</td>
</tr>
<tr class="even">
<td align="left">Energy</td>
<td align="right">0.36</td>
</tr>
<tr class="odd">
<td align="left">Ball</td>
<td align="right">0.30</td>
</tr>
</tbody>
</table>
<p>(3)For non-normal distributions: t distribution with 1 df,bimodel distribution, we can also get the conclusion that Energy test and Ball test are generally more powerful than nearest NN test by the result,and under this situation,the Energy test performs better.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>nsimu4 <span class="ot">&lt;-</span> <span class="dv">100</span>; k<span class="ot">&lt;-</span><span class="dv">3</span>; p<span class="ot">&lt;-</span><span class="dv">2</span>; u<span class="ot">=</span><span class="fl">1.2</span>;<span class="fu">set.seed</span>(<span class="dv">190</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>nx <span class="ot">&lt;-</span> <span class="dv">30</span>; ny <span class="ot">&lt;-</span> <span class="dv">50</span>; nt<span class="ot">&lt;-</span><span class="fl">1e3</span>; n <span class="ot">&lt;-</span> nx<span class="sc">+</span>ny; Nc <span class="ot">=</span> <span class="fu">c</span>(nx,ny)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>pvalue <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,nsimu4,<span class="dv">3</span>)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>R<span class="ot">=</span><span class="dv">999</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsimu4){</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>  xsample <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(nx<span class="sc">*</span>p,<span class="fl">1.2</span>,<span class="dv">1</span>),<span class="at">ncol=</span>p);</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>  ysample <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rnorm</span>(ny),<span class="fu">rnorm</span>(ny,u));</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>  ztest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(xsample,ysample)</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">test.nn</span>(ztest,Nc,k)<span class="sc">$</span>p.value</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(ztest,<span class="at">sizes=</span>Nc,<span class="at">R=</span>nt)<span class="sc">$</span>p.value</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>xsample,<span class="at">y=</span>ysample,<span class="at">num.permutations=</span><span class="fl">1e3</span>,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">1522</span>)<span class="sc">$</span>p.value</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>; </span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>getpower4 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(pvalue<span class="sc">&lt;</span>alpha)</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>getpower <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(getpower4,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">row.names=</span><span class="fu">c</span>(<span class="st">&quot;NN&quot;</span>,<span class="st">&#39;Energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>))</span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(getpower)<span class="ot">=</span><span class="st">&quot;p-value&quot;</span></span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(getpower)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NN</td>
<td align="right">0.77</td>
</tr>
<tr class="even">
<td align="left">Energy</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">Ball</td>
<td align="right">0.98</td>
</tr>
</tbody>
</table>
<p>(4)For unbalanced samples,I set the <span class="math inline">\(n_1=30,n_2=50\)</span>,<span class="math inline">\(\mu_1=\mu_2=1.2\)</span>,<span class="math inline">\(\sigma_1=\sigma_2=1\)</span>. From the output of simulation,we can also get the conclusion that Energy test and Ball test are generally more powerful than nearest NN test,and under this situation,the Energy test performs better.</p>
<p>#HW8</p>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Exercise 9.3:Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchy or qt with df=1). Recall that a Cauchy(<span class="math inline">\(\theta,\eta\)</span>) distribution has density function <span class="math inline">\(f(x)=\frac{1}{\theta \pi (1+[(x-\eta)/\theta]^2)},\quad -\infty&lt;x&lt;\infty,\theta&gt;0.\)</span> The standard Cauchy has the Cauchy(<span class="math inline">\(\theta= 1, \eta= 0\)</span>) density. (Note that the standard Cauchy density is equal to the Student t density with one degree of freedom.)<br />
Exercise 9.8:This example appears in [40]. Consider the bivariate density <span class="math inline">\(f(x,y) \propto \binom n x y^{x+a-1}(1-y)^{n-x+b-1},x=0,1,...,n,0\leq y \leq 1.\)</span> It can be shown (see e.g. [23]) that for fixed a,b,n, the conditional distributions are Binomial(n,y) and Beta(x+a, n−x+b). Use the Gibbs sampler to generate a chain with target joint density f(x, y).<br />
</p>
<p>Note: For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt; 1.2\)</span>.</p>
</div>
<div id="answer-17" class="section level2">
<h2>Answer</h2>
<p>Exercise 9.3:<br />
Using M-H Algorithm as follows:<br />
1. Set g(·|X) to the density of <span class="math inline">\(N(X,1)\)</span>.[I choose the <span class="math inline">\(N(X,1)\)</span> as the proposal distribution]<br />
2. Generate <span class="math inline">\(X_0\)</span> from distribution <span class="math inline">\(N(0,1)\)</span> and store in x[1].<br />
3. Repeat for i = 2,…,N:<br />
(a) Generate Y from <span class="math inline">\(N(X_t,1)\)</span>.<br />
(b) Generate U from Uniform(0,1).<br />
(c) With <span class="math inline">\(X_t\)</span> = x[i-1], compute <span class="math inline">\(r(X_t, Y ) = \frac{f(Y)g(X_t|Y )}{f(X_t)g(Y|X_t)}\)</span>, where f is the standard Cauchy distribution, g(Y|X_t) is the <span class="math inline">\(N(X_t,1)\)</span> density evaluated at Y , and g(X_t|Y ) is the <span class="math inline">\(N(Y,1)\)</span>density evaluated at <span class="math inline">\(X_t\)</span>.<br />
If U ≤ r(<span class="math inline">\(X_t\)</span>, Y ) accept Y and set <span class="math inline">\(X_{t+1}\)</span> = Y ; otherwise set <span class="math inline">\(X_{t+1}\)</span> = <span class="math inline">\(X_t\)</span>. Store <span class="math inline">\(X_{t+1}\)</span> in x[i].<br />
(d) Increment t</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write a function to generate the chain</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>samplemh <span class="ot">&lt;-</span> <span class="cf">function</span>(ns,xinit){</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  mhx <span class="ot">&lt;-</span> <span class="fu">numeric</span>(ns)</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  mhx[<span class="dv">1</span>] <span class="ot">&lt;-</span> xinit</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  ut <span class="ot">&lt;-</span> <span class="fu">runif</span>(ns)</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>ns) {</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>        xt <span class="ot">&lt;-</span> mhx[j<span class="dv">-1</span>]</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>        y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,xt,<span class="dv">1</span>)</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>        pv <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(y)<span class="sc">*</span><span class="fu">dnorm</span>(xt,y,<span class="dv">1</span>)<span class="sc">/</span>(<span class="fu">dcauchy</span>(xt)<span class="sc">*</span><span class="fu">dnorm</span>(y,xt,<span class="dv">1</span>))</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (ut[j] <span class="sc">&lt;=</span> pv){ mhx[j] <span class="ot">=</span> y} </span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> {mhx[j]<span class="ot">=</span>xt} </span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a> <span class="fu">return</span>(mhx)</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20211</span>)</span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a>xit <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)<span class="co">#set initial value</span></span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a>ns<span class="ot">=</span><span class="fl">2e4</span></span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a>mhy <span class="ot">&lt;-</span> <span class="fu">samplemh</span>(ns,xit)</span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mhy[<span class="dv">15000</span><span class="sc">:</span><span class="dv">15500</span>], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">main=</span><span class="st">&quot;Time series of simulation&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co">#compare deciles</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>prb <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>dq1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(mhy[<span class="dv">1001</span><span class="sc">:</span>ns],<span class="at">probs =</span> prb)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>dq2 <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(prb)</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>dq1<span class="sc">-</span>dq2</span></code></pre></div>
<pre><code>##          10%          20%          30%          40%          50%          60% 
##  1.040901199  0.277426530  0.110733143  0.051604132  0.023333668 -0.006216276 
##          70%          80%          90% 
## -0.070547291 -0.200315150 -0.860448766</code></pre>
<p>We can generate random variable from a standard Cauchy distribution using the Metropolis-Hastings sample by above codes. After discarding the first 1000 of the chain,we can get the deciles of the generated observations and the standard Cauchy distribution by the function “quantile” and “qcauchy” in R. We can observe that the deciles of the generated sample are almost smaller than the standard Cauchy. Besides,the difference of tenth percentile and ninetieth percentile is a bit big.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write the function to compute G-R statistic </span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>GR <span class="ot">&lt;-</span> <span class="cf">function</span>(phi) {</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>        phi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(phi)</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>        m <span class="ot">&lt;-</span> <span class="fu">ncol</span>(phi)</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>        n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(phi)</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>phimeans <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(phi)     </span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>        B <span class="ot">&lt;-</span> m<span class="sc">*</span><span class="fu">var</span>(phimeans) </span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>    phiw <span class="ot">&lt;-</span> <span class="fu">apply</span>(phi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>        w <span class="ot">&lt;-</span> <span class="fu">mean</span>(phiw)        </span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>        vhat <span class="ot">&lt;-</span> w<span class="sc">*</span>(m<span class="dv">-1</span>)<span class="sc">/</span>m <span class="sc">+</span> (B<span class="sc">/</span>m)</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>        Rhat <span class="ot">&lt;-</span> vhat<span class="sc">/</span>w  </span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(Rhat)</span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="dv">3</span>         </span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>    ns <span class="ot">&lt;-</span> <span class="fl">1e4</span>     </span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>    bn <span class="ot">&lt;-</span> <span class="fl">1e3</span>   </span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">1321</span>)</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>    xint <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(k)</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>    spx <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>ns)</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>        spx[i, ] <span class="ot">&lt;-</span> <span class="fu">samplemh</span>(ns,xint[i])</span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#compute diagnostic statistics</span></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>    phi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(spx, <span class="dv">1</span>, cumsum))</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(phi))</span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>        phi[i,] <span class="ot">&lt;-</span> phi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(phi))</span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot</span>((bn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>ns,phi[i, (bn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>ns], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>,<span class="dv">1</span>),</span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab=</span><span class="st">&#39;Index&#39;</span>, <span class="at">ylab=</span><span class="fu">bquote</span>(phi))</span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">lines</span>(phi[i, (bn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>ns], <span class="at">col=</span>i)</span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, ns)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> (bn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>ns)</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>        rhat[j] <span class="ot">&lt;-</span> <span class="fu">GR</span>(phi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(rhat[(bn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>ns], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>According to the above codes,we can monitor convergence of the chain by using the Gelman-Rubin method, and the chain converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt; 1.2\)</span>.<br />
</p>
<p>Exercise 9.8: For the bivariate distribution (X, Y), at each iteration the Gibbs sampler:<br />
1. Sets (x, y) = X(t − 1);<br />
2. Generates <span class="math inline">\(X^{*}\)</span> from Binomial(n,y);<br />
3. Updates x =<span class="math inline">\(X^{*}\)</span>;<br />
4. Generates <span class="math inline">\(Y^{*}\)</span> from Beta(x+a, n−x+b);<br />
5. Sets X(t)=(<span class="math inline">\(X^{*}\)</span>,<span class="math inline">\(Y^{*}\)</span>)</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write a function to generate the chain by using Gibbs sample</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>bichain <span class="ot">&lt;-</span> <span class="cf">function</span>(nt,n,a,b){</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>  sample <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, nt, <span class="dv">2</span>)</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="at">min=</span><span class="dv">0</span>,<span class="at">max=</span>n)</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>  sample[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x1,y1) <span class="co">#initialize</span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>nt) {</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> sample[j<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>  sample[j, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> sample[j, <span class="dv">1</span>]</span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>  sample[j, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sample)</span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize constants and parameters</span></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a>nt <span class="ot">&lt;-</span> <span class="fl">1e4</span> <span class="co">#length of chain</span></span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="fl">1e3</span> <span class="co">#burn-in length</span></span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a>bn <span class="ot">&lt;-</span> burn<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a><span class="co">#generate a chain with target joint density f(x,y)</span></span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true" tabindex="-1"></a>spxy <span class="ot">&lt;-</span> <span class="fu">bichain</span>(nt,n,a,b)[(bn<span class="sc">:</span>nt),]</span></code></pre></div>
<p>According to the above code,we can generate a chain with target joint density f(x,y).</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1321</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>spxy1 <span class="ot">&lt;-</span> <span class="fu">bichain</span>(nt,n,a,b)</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>spxy2 <span class="ot">&lt;-</span> <span class="fu">bichain</span>(nt,n,a,b)</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>spxy3 <span class="ot">&lt;-</span> <span class="fu">bichain</span>(nt,n,a,b)</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>sspx<span class="ot">=</span><span class="fu">rbind</span>(spxy1[,<span class="dv">1</span>],spxy2[,<span class="dv">1</span>],spxy3[,<span class="dv">1</span>])</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>sspy<span class="ot">=</span><span class="fu">rbind</span>(spxy1[,<span class="dv">2</span>],spxy2[,<span class="dv">2</span>],spxy3[,<span class="dv">2</span>]) </span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>phi1 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(sspx, <span class="dv">1</span>, cumsum))</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>phi2 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(sspy, <span class="dv">1</span>, cumsum))</span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(phi1))</span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>phi1[i,] <span class="ot">&lt;-</span> phi1[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(phi1))</span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>phi2[i,] <span class="ot">&lt;-</span> phi2[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(phi2))</span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">GR</span>(phi1),<span class="fu">GR</span>(phi2)))</span></code></pre></div>
<pre><code>## [1] 1.035881 1.021268</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>r.bino <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nt)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>r.beta <span class="ot">&lt;-</span><span class="fu">numeric</span>(nt)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(l <span class="cf">in</span>(bn)<span class="sc">:</span>nt){</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>r.bino[l]<span class="ot">&lt;-</span><span class="fu">GR</span>(phi1[,<span class="dv">1</span><span class="sc">:</span>l])</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>r.beta[l]<span class="ot">&lt;-</span><span class="fu">GR</span>(phi2[,<span class="dv">1</span><span class="sc">:</span>l])</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) </span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(r.bino[(bn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>nt],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;N&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(r.beta[(bn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>nt],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;N&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>According to the above codes,we can monitor convergence of the chain by using the Gelman-Rubin method, and the chain converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt; 1.2\)</span>.<br />
</p>
<p>#HW9</p>
</div>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<p>Exercise 11.3: (a) Write a function to compute the kth term in <span class="math inline">\(\sum_{k=0}^{\infty} \frac{(-1)^k}{k!2^k} \frac{\left \|a\right \|^{2k+2}}{(2k+1)(2k+2)} \frac{ \Gamma(\frac{d+1}{2})\Gamma(k+\frac{3}{2})}{\Gamma(k+\frac{d}{2}+1)}\)</span>, where <span class="math inline">\(d ≥ 1\)</span> is an integer, <span class="math inline">\(a\)</span> is a vector in <span class="math inline">\(R^d\)</span>, and <span class="math inline">\(\left \|. \right \|\)</span>denotes the Euclidean norm. Perform the arithmetic so that the coefficients can be computed for (almost) arbitrarily large <span class="math inline">\(k\)</span> and <span class="math inline">\(d\)</span>.(This sum converges for all <span class="math inline">\(a \in R^d\)</span>).<br />
(b) Modify the function so that it computes and returns the sum.<br />
(c) Evaluate the sum when <span class="math inline">\(a = (1, 2)^T\)</span> .</p>
</div>
<div id="answer-18" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the function to compute the kth term</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>termk <span class="ot">&lt;-</span> <span class="cf">function</span>(a,k){</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">=</span><span class="fu">length</span>(a)</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  odist <span class="ot">&lt;-</span> <span class="fu">norm</span>(a,<span class="at">type =</span> <span class="st">&quot;2&quot;</span>)</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){s<span class="ot">=</span>s<span class="sc">+</span><span class="fu">log</span>(i)}</span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>  tk <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k <span class="sc">*</span><span class="fu">exp</span>((k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">log</span>(odist<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="fl">+1.5</span>)<span class="sc">-</span>s<span class="sc">-</span>k<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tk)</span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a><span class="fu">termk</span>(a,k)</span></code></pre></div>
<pre><code>## [1] 7.232135e-124</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co">#(b) the function that it computes and returns the sum</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>fsum <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  od <span class="ot">&lt;-</span> <span class="fu">norm</span>(a,<span class="at">type=</span><span class="st">&quot;2&quot;</span>)</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span><span class="fu">length</span>(a)</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>  initn<span class="ot">=</span>od<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">gamma</span>((n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">gamma</span>(<span class="fl">1.5</span>)</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>  initd<span class="ot">=</span><span class="dv">2</span><span class="sc">*</span><span class="fu">gamma</span>(n<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>  init<span class="ot">=</span>initn<span class="sc">/</span>initd</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fl">1e4</span>){</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">abs</span>(<span class="fu">termk</span>(a,k))<span class="sc">&lt;</span><span class="fl">1e-24</span>){init<span class="ot">=</span>init}</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>{init <span class="ot">&lt;-</span> init<span class="sc">+</span><span class="fu">termk</span>(a,k)</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(init)</span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a><span class="co">#(c)</span></span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a><span class="fu">fsum</span>(a)</span></code></pre></div>
<pre><code>## [1] 1.532164</code></pre>
<p>We can get the sum is 1.532164 when a=(1,2)^T.</p>
</div>
<div id="question-2-5" class="section level2">
<h2>Question 2</h2>
<p>Exercise 11.5:Write a function to solve the equation</p>
<p><span class="math inline">\(\frac{2 \Gamma(\frac{k}{2})}{\sqrt{\pi(k-1)}\Gamma(\frac{k-1}{2})}\int_0^{c_{k-1}}(1+\frac{u^2}{k-1})^{-\frac{k}{2}}du=\frac{2 \Gamma(\frac{k+1}{2})}{\sqrt{\pi k}\Gamma(\frac{k}{2})}\int_0^{c_k}(1+\frac{u^2}{k})^{-\frac{k+1}{2}}du\)</span> for a,where <span class="math inline">\(c_k=\sqrt{\frac{a^2 k}{k+1-a^2}}\)</span>.<br />
Compare the solutions with the points A(k) in Exercise 11.4.</p>
</div>
<div id="answer-19" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>upbd <span class="ot">&lt;-</span> <span class="cf">function</span>(a,k){<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))}</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>encore <span class="ot">&lt;-</span> <span class="cf">function</span>(x,k){(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>k)<span class="sc">^</span>(<span class="sc">-</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)}</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>coe <span class="ot">&lt;-</span> <span class="cf">function</span>(k){<span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(pi<span class="sc">*</span>k)<span class="sc">*</span><span class="fu">exp</span>(<span class="fu">lgamma</span>((k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">/</span><span class="dv">2</span>))}</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>sofunc <span class="ot">&lt;-</span> <span class="cf">function</span>(a,k){</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.vector</span>(a)) a <span class="ot">&lt;-</span> <span class="fu">c</span>(a)</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span><span class="fu">length</span>(a)</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>  inte1<span class="ot">&lt;-</span><span class="fu">integrate</span>(encore,<span class="at">lower=</span><span class="dv">0</span>,<span class="at">upper=</span><span class="fu">upbd</span>(a[i],k<span class="dv">-1</span>),<span class="at">k=</span>k<span class="dv">-1</span>)<span class="sc">$</span>value</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>inte2 <span class="ot">&lt;-</span> <span class="fu">integrate</span>(encore,<span class="at">lower=</span><span class="dv">0</span>,<span class="at">upper=</span><span class="fu">upbd</span>(a[i],k),<span class="at">k=</span>k)<span class="sc">$</span>value</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>out[i] <span class="ot">&lt;-</span> <span class="fu">coe</span>(k)<span class="sc">*</span>inte2<span class="sc">-</span><span class="fu">coe</span>(k<span class="dv">-1</span>)<span class="sc">*</span>inte1</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>out</span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>result1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">15</span>)</span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">20</span>){</span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>result1[k<span class="dv">-3</span>] <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(sofunc,<span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">1e-5</span>,(k<span class="dv">-1</span>)<span class="sc">^</span><span class="fl">0.5</span>), <span class="at">k=</span>k)<span class="sc">$</span>root</span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a>result1</span></code></pre></div>
<pre><code>##  [1] 1.492102 1.533556 1.562727 1.584434 1.601192 1.614519 1.625383 1.634385
##  [9] 1.642026 1.648556 1.654169 1.659096 1.663433 1.667285 1.670707 1.673830
## [17] 1.676638</code></pre>
<p>we can obtain the solutions of the equation by above codes.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co">#11.4</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>ga <span class="ot">&lt;-</span> <span class="cf">function</span>(a,k){</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pt</span>(<span class="fu">upbd</span>(a,k),<span class="at">df=</span>k)<span class="sc">-</span><span class="fu">pt</span>(<span class="fu">upbd</span>(a,k<span class="dv">-1</span>),<span class="at">df=</span>k<span class="dv">-1</span>)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>result2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">15</span>)</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">20</span>){</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>  result2[k<span class="dv">-3</span>] <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(ga,<span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">1e-6</span>,(k<span class="dv">-1</span>)<span class="sc">^</span><span class="fl">0.5</span>), <span class="at">k=</span>k)<span class="sc">$</span>root</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>result1<span class="sc">-</span>result2</span></code></pre></div>
<pre><code>##  [1]  4.245670e-11 -3.801313e-10  9.503449e-10  3.391134e-09 -1.925231e-07
##  [6]  3.700701e-07 -1.264294e-08 -1.484278e-05  2.631546e-07  1.491086e-05
## [11] -7.418207e-06 -1.907951e-05 -1.182885e-06  1.345361e-05 -1.877329e-05
## [16]  7.023079e-06  2.815017e-06</code></pre>
<p>We can get the conclusion that the solutions of 11.4 and 11.5 is close because their difference is almost less than <span class="math inline">\(10^{-5}\)</span>.</p>
</div>
<div id="question-3-4" class="section level2">
<h2>Question 3</h2>
<p>Suppose <span class="math inline">\(T_1, . . . , T_n\)</span> are i.i.d. samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>. Those values greater than <span class="math inline">\(\tau\)</span> are not observed due to right censorship, so that the observed values are <span class="math inline">\(Y_i = T_iI(T_i ≤ \tau ) + τ I(T_i&gt;\tau),i = 1, . . . , n.\)</span> Suppose <span class="math inline">\(\tau = 1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows:<br />
<span class="math inline">\(~ 0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85\)</span><br />
Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the observed data MLE(note:<span class="math inline">\(Y_i\)</span> follows a mixture distribution).</p>
</div>
<div id="answer-20" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(y)</span></code></pre></div>
<pre><code>## [1] 6.75</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(y)</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<!-- ![Derivatiion of EM estimator](figure/em.jpg)` -->
<p>#HW10</p>
</div>
<div id="question-1-2" class="section level2">
<h2>Question 1</h2>
<p>Exercises 1 and 5 (page 204, Advanced R)<br />
Exercise 1:Why are the following two invocations of lapply() equivalent?<br />
trims &lt;- c(0,0.1,0.2,0.5)<br />
x &lt;- rcauchy(100)<br />
lapply(trims,function(trim) mean(x,trim=trim))<br />
lapply(trims,mean,x=x)<br />
Exercise 5:For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below. rsq &lt;- function(mod) summary(mod)$r.squared</p>
</div>
<div id="answer-21" class="section level2">
<h2>Answer</h2>
<p>Exercise 1:<br />
Because the two invocations of lapply() both require to calculate the mean of x after trimming a fraction of it and the proportion is taken through the value in the vector “trims”.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>trims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.5</span>)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rcauchy</span>(<span class="dv">100</span>)</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims,<span class="cf">function</span>(trim) <span class="fu">mean</span>(x,<span class="at">trim=</span>trim))</span></code></pre></div>
<pre><code>## [[1]]
## [1] -0.4324799
## 
## [[2]]
## [1] 0.2499562
## 
## [[3]]
## [1] 0.1428463
## 
## [[4]]
## [1] 0.01224752</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims,mean,<span class="at">x=</span>x)</span></code></pre></div>
<pre><code>## [[1]]
## [1] -0.4324799
## 
## [[2]]
## [1] 0.2499562
## 
## [[3]]
## [1] 0.1428463
## 
## [[4]]
## [1] 0.01224752</code></pre>
<p>Exercise 5:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co">#extract r_2 in exercise 4</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp,</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>formu <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(formulas), <span class="cf">function</span>(i) <span class="fu">lm</span>(formulas[[i]],<span class="at">data=</span>mtcars))</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(<span class="fu">seq_along</span>(formu), <span class="cf">function</span>(i) <span class="fu">rsq</span>(formu[[i]]))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="do">##extract r_2 in exercise 5</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>mtcars.new <span class="ot">&lt;-</span> mtcars[rows, ]</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(mpg<span class="sc">~</span>disp,<span class="at">data=</span>mtcars.new)</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) <span class="fu">rsq</span>(bootstraps[[i]]))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.6756044
## 
## [[2]]
## [1] 0.7267877
## 
## [[3]]
## [1] 0.7297379
## 
## [[4]]
## [1] 0.7758251
## 
## [[5]]
## [1] 0.7235397
## 
## [[6]]
## [1] 0.7901675
## 
## [[7]]
## [1] 0.6560032
## 
## [[8]]
## [1] 0.6591434
## 
## [[9]]
## [1] 0.7909723
## 
## [[10]]
## [1] 0.757583</code></pre>
</div>
<div id="question-2-6" class="section level2">
<h2>Question 2</h2>
<p>Exercises 1 and 7 (page 214, Advanced R)<br />
Exercises 1:Use vapply() to:<br />
a) Compute the standard deviation of every column in a numeric data frame.<br />
b) Compute the standard deviation of every numeric column in a mixed data frame. (Hint: you’ll need to use vapply() twice.)<br />
Exercises 7:Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()?Why or why not?</p>
</div>
<div id="answer-22" class="section level2">
<h2>Answer</h2>
<p>Exercises 1:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co">#(a)</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>da <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>),<span class="at">nrow=</span><span class="dv">5</span>)</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>da <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(da)</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(da,sd,<span class="at">FUN.VALUE =</span> <span class="dv">0</span>) </span></code></pre></div>
<pre><code>##       V1       V2       V3       V4 
## 1.581139 1.581139 1.581139 1.581139</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co">#existing data frame</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(mtcars, sd, <span class="at">FUN.VALUE =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>##         mpg         cyl        disp          hp        drat          wt 
##   6.0269481   1.7859216 123.9386938  68.5628685   0.5346787   0.9784574 
##        qsec          vs          am        gear        carb 
##   1.7869432   0.5040161   0.4989909   0.7378041   1.6152000</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co">#(b)</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="co">#when the non-numeric variable is easy to drop</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(iris,is.numeric,<span class="fu">logical</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width      Species 
##         TRUE         TRUE         TRUE         TRUE        FALSE</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>iris.new <span class="ot">&lt;-</span> iris[,<span class="sc">-</span><span class="dv">5</span>]</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(iris.new,sd,<span class="at">FUN.VALUE =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##    0.8280661    0.4358663    1.7652982    0.7622377</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write a function to come true</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>sd.mix <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">vapply</span>(x[<span class="fu">vapply</span>(x,is.numeric,<span class="fu">logical</span>(<span class="dv">1</span>))], sd, <span class="at">FUN.VALUE =</span> <span class="dv">0</span>)</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sd.mix</span>(iris)</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##    0.8280661    0.4358663    1.7652982    0.7622377</code></pre>
<p>Exercise 7:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>mcsapply <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">cluster =</span> <span class="cn">NULL</span>, X, FUN, ..., <span class="at">simplify =</span> <span class="cn">TRUE</span>,<span class="at">USE.NAMES =</span> <span class="cn">TRUE</span>){</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>   FUN <span class="ot">&lt;-</span> <span class="fu">match.fun</span>(FUN)</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  answer <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">parLapply</span>(cluster,<span class="at">X =</span> X, <span class="at">fun =</span> FUN, ...)</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (USE.NAMES <span class="sc">&amp;&amp;</span> <span class="fu">is.character</span>(X) <span class="sc">&amp;&amp;</span> <span class="fu">is.null</span>(<span class="fu">names</span>(answer))) <span class="fu">names</span>(answer) <span class="ot">&lt;-</span> X</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">identical</span>(simplify, <span class="cn">FALSE</span>) <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(answer))</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">simplify2array</span>(answer, <span class="at">higher =</span> (simplify <span class="sc">==</span> <span class="st">&quot;array&quot;</span>))</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> answer</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>()</span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makePSOCKcluster</span>(cores)</span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a><span class="fu">mcsapply</span>(cluster, <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="fu">get</span>(<span class="st">&quot;+&quot;</span>),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  [1]  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>da <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span><span class="sc">*</span><span class="dv">1024</span>,<span class="at">nrow=</span><span class="dv">8</span>)</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>da <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(da)</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">mcsapply</span>(cluster,da,sd))</span></code></pre></div>
<pre><code>## 用户 系统 流逝 
##    0    0    0</code></pre>
<p>I can not implement mcvapply(),a parallel version of vapply(). vapply() does not map to lapply() like sapply() does,so it would be more difficult.</p>
<p>#HW11 ## Question 1.Write a Rcpp function for Exercise 9.8(page 278,Statistical Computing with R)<br />
Exercise 9.8:This example appears in [40]. Consider the bivariate density <span class="math inline">\(f(x,y) \propto \binom n x y^{x+a-1}(1-y)^{n-x+b-1},x=0,1,...,n,0\leq y \leq 1.\)</span> It can be shown (see e.g. [23]) that for fixed a,b,n, the conditional distributions are Binomial(n,y) and Beta(x+a, n−x+b). Use the Gibbs sampler to generate a chain with target joint density f(x, y).<br />
</p>
<p>2.Compare the corresponding generated random numbers with pure R language using the function “qqplot”.<br />
</p>
<p>3.Compare the computation time of the two functions with the function “microbenchmark”.<br />
</p>
<p>4.Comments your results.</p>
</div>
<div id="answer-23" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="do">###########Write a Rcpp function for Exercise 9.8</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="co">#direct_cpp &lt;- &quot;D:/Rcpp/&quot;</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a><span class="co">#sourceCpp(paste0(direct_cpp, &quot;gibbs_cpp.cpp&quot;)) </span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize constants and parameters</span></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;NumericMatrix gibbsC(int n,int n1,double a, double b){</span></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a><span class="st">  NumericMatrix mtsample(n, 2);</span></span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a><span class="st">    mtsample(0,0)=1;mtsample(0,1)=0.1;</span></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a><span class="st">    for(int i = 1;i &lt; n ; i++) {</span></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a><span class="st"> double y = mtsample(i-1, 1);</span></span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a><span class="st">  mtsample(i, 0) = rbinom(1, n1, y)[0];</span></span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a><span class="st">  double x =mtsample(i, 0);</span></span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a><span class="st">  mtsample(i, 1) =rbeta(1,x+a,n1-x+b)[0];</span></span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a><span class="st">    return(mtsample);</span></span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb155-18"><a href="#cb155-18" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb155-19"><a href="#cb155-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb155-20"><a href="#cb155-20" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e4</span> <span class="co">#length of chain</span></span>
<span id="cb155-21"><a href="#cb155-21" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb155-22"><a href="#cb155-22" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb155-23"><a href="#cb155-23" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb155-24"><a href="#cb155-24" aria-hidden="true" tabindex="-1"></a>mtrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,n,<span class="dv">2</span>)</span>
<span id="cb155-25"><a href="#cb155-25" aria-hidden="true" tabindex="-1"></a>mtrix <span class="ot">&lt;-</span> <span class="fu">gibbsC</span>(n,n1,a,b)</span>
<span id="cb155-26"><a href="#cb155-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-27"><a href="#cb155-27" aria-hidden="true" tabindex="-1"></a><span class="do">###################</span></span>
<span id="cb155-28"><a href="#cb155-28" aria-hidden="true" tabindex="-1"></a>bichain <span class="ot">&lt;-</span> <span class="cf">function</span>(nt,n,a,b){</span>
<span id="cb155-29"><a href="#cb155-29" aria-hidden="true" tabindex="-1"></a>  sampleb <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, nt, <span class="dv">2</span>)</span>
<span id="cb155-30"><a href="#cb155-30" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="at">min=</span><span class="dv">0</span>,<span class="at">max=</span>n)</span>
<span id="cb155-31"><a href="#cb155-31" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb155-32"><a href="#cb155-32" aria-hidden="true" tabindex="-1"></a>  sampleb[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x1,y1) <span class="co">#initialize</span></span>
<span id="cb155-33"><a href="#cb155-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>nt) {</span>
<span id="cb155-34"><a href="#cb155-34" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> sampleb[j<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb155-35"><a href="#cb155-35" aria-hidden="true" tabindex="-1"></a>  sampleb[j, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb155-36"><a href="#cb155-36" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> sampleb[j, <span class="dv">1</span>]</span>
<span id="cb155-37"><a href="#cb155-37" aria-hidden="true" tabindex="-1"></a>  sampleb[j, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb155-38"><a href="#cb155-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb155-39"><a href="#cb155-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sampleb)</span>
<span id="cb155-40"><a href="#cb155-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb155-41"><a href="#cb155-41" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e4</span> <span class="co">#length of chain</span></span>
<span id="cb155-42"><a href="#cb155-42" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb155-43"><a href="#cb155-43" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb155-44"><a href="#cb155-44" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb155-45"><a href="#cb155-45" aria-hidden="true" tabindex="-1"></a>mtrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,n,<span class="dv">2</span>)</span>
<span id="cb155-46"><a href="#cb155-46" aria-hidden="true" tabindex="-1"></a>mtrix <span class="ot">&lt;-</span> <span class="fu">gibbsC</span>(n,n1,a,b)</span>
<span id="cb155-47"><a href="#cb155-47" aria-hidden="true" tabindex="-1"></a>mtrix1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,n,<span class="dv">2</span>)</span>
<span id="cb155-48"><a href="#cb155-48" aria-hidden="true" tabindex="-1"></a>mtrix1 <span class="ot">&lt;-</span> <span class="fu">bichain</span>(n,n1,a,b)</span>
<span id="cb155-49"><a href="#cb155-49" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(mtrix[,<span class="dv">1</span>],mtrix1[,<span class="dv">1</span>],<span class="at">xlab =</span> <span class="st">&quot;quantiles of gibbC &quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;quantiles of gibbR&quot;</span>,<span class="at">main=</span><span class="st">&quot;qq-plot of x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(mtrix[,<span class="dv">2</span>],mtrix1[,<span class="dv">2</span>],<span class="at">xlab =</span> <span class="st">&quot;quantiles of gibbC &quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;quantiles of gibbR&quot;</span>,<span class="at">main=</span><span class="st">&quot;qq-plot of y&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the output of qq-plot for x and y,we can get the conclusion that the distributions of the random number generated by the two means are nearly the same.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>nt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">500</span>,<span class="fl">1e3</span>,<span class="fl">5e3</span>,<span class="fl">1e4</span>)</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>mt <span class="ot">=</span><span class="fu">length</span>(nt)</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="at">length=</span>mt)</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>sumts <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="at">length=</span>mt)</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>mt){</span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>ts[[i]] <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gibbC=</span><span class="fu">gibbsC</span>(nt[i],<span class="dv">10</span>,<span class="dv">2</span>,<span class="dv">2</span>), </span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">gibbR=</span><span class="fu">bichain</span>(nt[i],<span class="dv">10</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>    sumts[[i]]<span class="ot">&lt;-</span><span class="fu">summary</span>(ts[[i]])[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a>sumts</span></code></pre></div>
<pre><code>## [[1]]
##    expr    lq median     uq
## 1 gibbC  28.6  29.70  31.65
## 2 gibbR 274.5 278.95 299.60
## 
## [[2]]
##    expr      lq median      uq
## 1 gibbC  137.30  140.2  145.90
## 2 gibbR 1372.85 1405.7 1526.35
## 
## [[3]]
##    expr      lq  median     uq
## 1 gibbC  273.85  284.05  291.1
## 2 gibbR 2778.45 2835.95 2993.7
## 
## [[4]]
##    expr       lq   median       uq
## 1 gibbC  1.37165  1.38810  1.45905
## 2 gibbR 14.33275 19.27805 19.57005
## 
## [[5]]
##    expr       lq   median       uq
## 1 gibbC  2.74770  2.80315  2.88790
## 2 gibbR 33.65645 34.38490 37.28535</code></pre>
<p>For different quantity of random number,we can observe that the cpp function takes much less time to computation than the pure R language. Moreover the computation time of pure R language is almost ten times as the cpp function.<br />
</p>
<p>Comments:The cpp function can get output as concrete as pure R language in a much faster speed. We can get concrete and fast results by using the cpp function in R when it comes to a lot of operations.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
